{% extends 'base.html' %}

{% load static %}
{% load crispy_forms_tags %}
{% load widget_tweaks %}

{% block titulo %}
Adrofecha - Orçamento
{% endblock %}

{% block css %}
<link rel="stylesheet" href="{% static 'Pedidos/css/style.css' %}">
<script src="{% static 'Pedidos/js/Pedidos.js' %}"></script>
{% endblock %}

{% block content %}
<div class="" style="margin-top: 50px">
    <div class="container container-flex">
      <div class="border rounded justify-content-start ps-1 radio-tile-group me-2" id="listabotoes">
        <div class="input-container">
          <input type="radio" name="btnradio" id="btnPortaGiro" value="PortaGiro" checked>
          <div class="radio-tile">
            <!-- <i class="bi bi-door-open"></i> -->
            <label for="btnPortaGiro">Giro</label>
          </div>
        </div>
        <div class="input-container">
          <input type="radio" name="btnradio" id="btnPortaCorrer" value="PortaCorrer">
          <div class="radio-tile">
            <!-- <ion-icon name="bicycle"></ion-icon> -->
            <label for="btnPortaCorrer">Correr</label>
          </div>
        </div>
        <div class="input-container">
          <input type="radio" name="btnradio" id="btnVidro" value="Vidros">
          <div class="radio-tile">
            <!-- <ion-icon name="airplane"></ion-icon> -->
            <label for="btnVidro">Vidro</label>
          </div>
        </div>
      </div>
      <div class="border rounded justify-content-start" id="selecionacliente">
        <h2 class="bg-warning text-dark text-center fs-6 fw-bold">Cliente</h2>
        <div id="inputsclientes" class="input-group ms-1">
            <input type="text" class="form-control" id="clienteInput" placeholder="Código" maxlength="6">
            <button class="btn btn-outline-secondary" type="button" id="btnBuscarCliente"><i class="fas fa-search"></i></button>
        </div>
        <input type="text" class="form-control" id="nomeCliente" readonly disabled>
      </div>
        <!-- Modal para busca do cliente -->
        <div class="modal fade" id="modalBuscaCliente" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Buscar Cliente</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                         <input type="text" id="buscaClienteInput" class="form-control mb-2" placeholder="Digite o código ou nome do cliente">
                         <button type="button" class="btn btn-primary">Buscar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container container-flex mt-1">
        <div class="border rounded justify-content-start col-6 ps-1 me-2" id="escolhas">
<!--====================  INPUTS =======================-->
            <form>
                <div class="row mb-1 mt-1">
                    <div class="row ms-1">
                        <div class="mt-1 col d-flex align-items-center justify-content-start">
                            <label class="me-1" for="{{ form.quantidade.id_for_label }}">
                                {{ form.quantidade.label_tag }}
                                {% if form.quantidade.field.required %}{% endif %}
                            </label>
                            {{ form.quantidade|attr:"class:form-control custom-input-size-quantidade" }}
                        </div>
                        <div class="mt-1 col d-flex align-items-center justify-content-center">
                            <label class="me-1" for="{{ form.largura.id_for_label }}">
                                {{ form.largura.label_tag }}
                                {% if form.largura.field.required %}{% endif %}
                            </label>
                            {{ form.largura|attr:"class:form-control custom-input-size-medida" }}
                        </div>
                        <div class="mt-1 col d-flex align-items-center justify-content-end">
                            <label class="me-1" for="{{ form.altura.id_for_label }}">
                                {{ form.altura.label_tag }}
                                {% if form.altura.field.required %}{% endif %}
                            </label>
                            {{ form.altura|attr:"class:form-control custom-input-size-medida" }}
                        </div>
                    </div>
                    <div class="row mx-3 pt-2">
                        <div class="row" id="divselecao">
                            <div class="col-6 d-flex justify-content-center align-items-center" id="divacabamento">
                                <label class="me-1" for="{{ form.acabamento.id_for_label }}">
                                    {{ form.acabamento.label_tag }}
                                    {% if form.acabamento.field.required %}{% endif %}
                                </label>
                                {{ form.acabamento|attr:"class:form-control custom-input-size-select" }}
                            </div>
                            <div class="col-6 d-flex justify-content-center align-items-center" id="divabertura">
                                <label class="me-1" for="{{ form.abertura.id_for_label }}">
                                    {{ form.abertura.label_tag }}
                                    {% if form.abertura.field.required %}{% endif %}
                                </label>
                                {{ form.abertura|attr:"class:form-control custom-input-size-select" }}
                            </div>
                        </div>
                    </div>
                </div>
            </form>
<!--====================  END INPUTS =======================-->
            <hr class="mx-2">
<!--                    Menu para giro e correr-->
            <div id="divportas" class="mt-1">
<!--                    Linha Perfil-->
                <div class="ms-1">
                    <div class="row justify-content-start" id="divperfil">
                        <label for="{{ form.perfil.id_for_label }}">
                            {{ form.perfil.label_tag }}
                            {% if form.perfil.field.required %}{% endif %}
                        </label>
                        <div>
                            {{ form.perfil|attr:"class:form-control custom-input-size-selectitems selectPerfil" }}
                        </div>
<!--                        <label class="mx-3" id="valorperfil"></label>-->
                    </div>
                </div>
<!--                    Linha Perfil Puxador-->
                <div class="ms-1">
                    <div id="divperfilpuxador">
                        <label for="{{ form.perfilpuxador.id_for_label }}">
                            {{ form.perfilpuxador.label_tag }}
                            {% if form.perfilpuxador.field.required %}{% endif %}
                        </label>
                        <div class="d-flex">
                            <div class="me-1">
                                {{ form.perfilpuxador|attr:"class:form-control custom-input-size-selectitems selectPerfilPuxador" }}
                            </div>
                            <div class="d-flex" >
                                <select class="form-control custom-input-qtd flex-grow-1 me-1" id="qtd-perfilpuxador"></select>
                                <select class="form-select custom-input-posicao flex-grow-1" id="posicao-perfilpuxador"></select>
                                <label class="mx-3" id="valorperfilpuxador"></label>
                            </div>
                        </div>
                    </div>
                </div>
<!--                    Linha Puxador Sobreposto-->
                <div class="ms-1">
                    <div id="divpuxador">
                        <label for="{{ form.puxador.id_for_label }}">
                            {{ form.puxador.label_tag }}
                            {% if form.puxador.field.required %}{% endif %}
                        </label>
                        <div class="d-flex">
                            <div class="me-1">
                                {{ form.puxador|attr:"class:form-control custom-input-size-selectitems selectPuxador" }}
                            </div>
                            <div class="d-flex">
                                <select class="form-control custom-input-qtd flex-grow-1 me-1" id="qtd-puxador"></select>
                                <select class="form-select custom-input-posicao flex-grow-1 me-1" id="posicao-puxador"></select>
                                <input class="form-control custom-input-size-medida flex-grow-1" id="tam-puxador">
                                <label class="mx-3" id="valorpuxador"></label>
                            </div>
                        </div>
                    </div>
                </div>
<!--                    Linha Divisor-->
                <div class="ms-1">
                    <div id="divdivisor">
                        <label for="{{ form.divisor.id_for_label }}">
                            {{ form.divisor.label_tag }}
                            {% if form.divisor.field.required %}{% endif %}
                        </label>
                        <div class="d-flex">
                            <div class="me-1">
                                {{ form.divisor|attr:"class:form-control custom-input-size-selectitems selectdivisor" }}
                            </div>
                            <div class="d-flex">
                                <select class="form-control custom-input-qtd flex-grow-1 me-1" id="qtd-divisor"></select>
                                <label class="mx-3" id="valordivisor"></label>
                            </div>
                        </div>
                    </div>
                </div>
<!--                    Linha Vidro-->
                <div class="ms-1">
                    <div id="divvidro" class="">
                        <label for="{{ form.vidro.id_for_label }}">
                            {{ form.vidro.label_tag }}
                            {% if form.vidro.field.required %}{% endif %}
                        </label>
                        <div class="me-1">
                            {{ form.vidro|attr:"class:form-control custom-input-size-selectitems selectVidro" }}
                        </div>
                    </div>
                    <!-- Campos de vidro extras -->
                    <div id="divvidro1" class="st2">
                        <label for="id_vidro1">
                            Vidro 1
                        </label>
                        <div class="me-1">
                            {{ form.vidro|attr:"class:form-control custom-input-size-selectitems selectVidro" |attr:"id:id_vidro1" }}
                        </div>
                    </div>
                    <div id="divvidro2" class="st2">
                        <label for="id_vidro2">
                            Vidro 2
                        </label>
                        <div class="me-1">
                            {{ form.vidro|attr:"class:form-control custom-input-size-selectitems selectVidro" |attr:"id:id_vidro2" }}
                        </div>
                    </div>
                    <div id="divvidro3" class="st2">
                        <label for="id_vidro3">
                            Vidro 3
                        </label>
                        <div class="me-1">
                            {{ form.vidro|attr:"class:form-control custom-input-size-selectitems selectVidro" |attr:"id:id_vidro3" }}
                        </div>
                    </div>
                </div>
            </div>
<!--                    menu para vidro-->
            <div id="divvidros" class="hidden">
                <div class="ms-1">
                    <div id="divvidro">
                        <label for="{{ form.vidro.id_for_label }}">
                            {{ form.vidro.label_tag }}
                            {% if form.vidro.field.required %}{% endif %}
                        </label>
                        <div class="me-1">
                            {{ form.vidro|attr:"class:form-control custom-input-size-selectitems selectVidro" }}
                        </div>
                    </div>
                </div>
            </div>
<!--                botoes finalizar-->
            <div class="mt-1 mb-2 text-end">
                <button type="reset" id="btnReset" class="btn btn-outline-dark ms-2 mt-1" style="width: 50px;" title="Reset">
                            <i class="fas fa-sync-alt"></i>
                </button>
                <button class="btn btn-primary me-2 mt-1" id="btnAdicionar">Adicionar</button>
            </div>
        </div>
<!--====================  DESENHO =======================-->
        <div class="border rounded justify-content-start col-6 ps-1" id="meu">
            <div id="descricaoporta" class="d-flex mt-2 justify-content-center align-items-center">
                <label class="text-center me-2" id="qtditens"></label>
                <label class="text-center" id="nomeporta"></label>
                <label class="ms-2 st2" id="cifraoporta">R$</label>
                <label class="text-center ms-1" id="valorporta"></label>
            </div>
            <div class="svg-content" id="Desenho">
                <svg id="svg" class="img-responsive" width="100%" viewBox="0 50 550 350"
                     xmlns="http://www.w3.org/2000/svg">
                    <style type="text/css">
                    .st0{fill:#D7D8D7;}
                    .st1{display:none;fill:#F4FDFF;}
                    .st2{display:none;}
                    .st3{display:inline;fill:#137009;}
                    .st4{opacity:0.45;}
                    .st5{fill:url(#Reflexo_1_);}
                    .st6{display:inline;}
                    .st7{font-family:'ArialMT';}
                    .st8{font-size:13px;}
                    .st9{fill:#AF0E0E;}
                    .st10{opacity:0.55;}
                    .st12{opacity:0.51;}
                    .st13{fill:#4C2F12;}
                    </style>
                    <g id="Porta" transform="translate(200, 70)">
                        <g id="Desenho">
                            <g id="Perfis" class="st2" fill="#D7D8D7">
                                <polygon id="perfil_esquerda" class=""
                                         points="3.1,57 3.1,293.7 14.1,282.7 14.1,68"/>
                                <polygon id="perfil_inferior" class=""
                                         points="141.7,282.7 14.1,282.7 3.1,293.7 152.7,293.7"/>
                                <polygon id="perfil_direita" class=""
                                         points="141.7,68 141.7,282.7 152.7,293.7 152.7,57"/>
                                <polygon id="perfil_superior" class=""
                                         points="152.7,57 3.1,57 14.1,68 141.7,68"/>
                            </g>
                            <g id="Divisores" class="">
                                <polygon id="Divisor-A" class="st2" fill="#137009" points="14.1,136.7 14.1,141 141.7,141 141.7,136.7"/>
                                <polygon id="Divisor-B" class="st2" fill="#137009" points="14.1,173.2 14.1,177.5 141.7,177.5 141.7,173.2"/>
                                <polygon id="Divisor-C" class="st2" fill="#137009" points="14.1,209.7 14.1,214 141.7,214 141.7,209.7"/>
                            </g>
                            <g id="Vidros">
                                <polygon id="Vidro" class="st2" fill="#DEF7FF" points="14.1,68 14.1,282.7 141.7,282.7 141.7,68"/>
                            </g>
                            <g id="Vidros2">
                                <polygon id="Vidro1_2" class="st2" fill="#DEF7FF" points="14.1,68 14.1,175.35 141.7,175.35 141.7,68"/>
                                <polygon id="Vidro2_2" class="st2" fill="#DEF7FF" points="14.1,179.65 14.1,282.7 141.7,282.7 141.7,179.65"/>
                            </g>
                            <g id="Vidros3">
                                <polygon id="Vidro1_3" class="st2" fill="#DEF7FF" points="14.1,68 14.1,136.7 141.7,136.7 141.7,68"/>
                                <polygon id="Vidro2_3" class="st2" fill="#DEF7FF" points="14.1,141.86 14.1,209.7 141.7,209.7 141.7,141.86"/>
                                <polygon id="Vidro3_3" class="st2" fill="#DEF7FF" points="14.1,214 14.1,282.7 141.7,282.7 141.7,214"/>
                            </g>
                            <g id="Puxadores" class="">
                                <g id="Puxador-Esquerda" class="st2 pux">
                                    <polygon id="Puxador-Esquerda-int" fill="#ff0000" points="3.1,57 3.1,293.7 5.85,293.7 5.85,57"/>
                                    <g id="Puxador-Esquerda-trecho" class="st2 pux"
                                       onclick="alterarCorPuxadores('Puxador-Esquerda-trecho')">
                                        <polygon id="Puxador-Esquerda-trecho-1" points="3.1,57 3.1,96.45 5.85,96.45 5.85,57"/>
                                        <polygon id="Puxador-Esquerda-trecho-2" points="3.1,155.62 3.1,195.08 5.85,195.08 5.85,155.62"/>
                                        <polygon id="Puxador-Esquerda-trecho-3" points="3.1,254.25 3.1,293.7 5.85,293.7 5.85,254.25"/>
                                    </g>
                                </g>
                                <g id="Puxador-Base" class="st2 pux">
                                    <polygon id="Puxador-Base-int" fill="#ff0000"
                                             points="3.1,290.95 3.1,293.7 152.7,293.7 152.7,290.95"/>
                                    <g id="Puxador-Base-trecho" class="st2 pux"
                                       onclick="alterarCorPuxadores('Puxador-Base-trecho')">
                                        <polygon id="Puxador-Base-trecho-1"
                                                 points="3.1,290.95 3.1,293.7 42.55,293.7 42.55,290.95"/>
                                        <polygon id="Puxador-Base-trecho-2"
                                                 points="52.96,290.95 52.96,293.7 102.82,293.7 102.82,290.95"/>
                                        <polygon id="Puxador-Base-trecho-3"
                                                 points="113.25,290.95 113.25,293.7 152.7,293.7 152.7,290.95"/>
                                    </g>
                                </g>
                                <g id="Puxador-Direita" class="st2 pux">
                                    <polygon id="Puxador-Direita-int" fill="#ff0000"
                                             points="149.95,57 149.95,293.7 152.7,293.7 152.7,57"/>
                                    <g id="Puxador-Direita-trecho" class="st2 pux"
                                       onclick="alterarCorPuxadores('Puxador-Direita-trecho')">
                                        <polygon id="Puxador-Direita-trecho-1"
                                                 points="149.95,57 149.95,96.45 152.7,96.45 152.7,57"/>
                                        <polygon id="Puxador-Direita-trecho-2"
                                                 points="149.95,155.62 149.95,195.08 152.7,195.08 152.7,155.62"/>
                                        <polygon id="Puxador-Direita-trecho-3"
                                                 points="149.95,254.25 149.95,293.7 152.7,293.7 152.7,254.25"/>
                                    </g>
                                </g>
                                <g id="Puxador-Topo" class="st2 pux">
                                    <polygon id="Puxador-Topo-int" fill="#ff0000"
                                             points="3.1,57 3.1,59.75 152.7,59.75 152.7,57"/>
                                    <g id="Puxador-Topo-trecho" class="st2 pux"
                                       onclick="alterarCorPuxadores('Puxador-Topo-trecho')">
                                        <polygon id="Puxador-Topo-trecho-1"
                                                 points="3.1,57 3.1,59.75 42.55,59.75 42.55,57"/>
                                        <polygon id="Puxador-Topo-trecho-2"
                                                 points="52.96,57 52.96,59.75 102.82,59.75 102.82,57"/>
                                        <polygon id="Puxador-Topo-trecho-3"
                                                 points="113.25,57 113.25,59.75 152.7,59.75 152.7,57"/>
                                    </g>
                                </g>
                            </g>
                            <g id="PerfisPuxadores">
                                <g id="PerfilPux-Esquerda" class="st2" fill="#151618">
                                    <polygon id="PerfilPux-Esquerda-Cava" class="st10"
                                             points="-1.6,57 -1.6,293.7 3.1,293.7 3.1,57"/>
                                    <polygon id="PerfilPux-Esquerda-detalhe"
                                             points="-4.77,57 -4.77,293.7 -1.6,293.7 -1.6,57"/>
                                </g>
                                <g id="PerfilPux-Base" class="st2" fill="#151618">
                                    <polygon id="PerfilPux-Base-Cava" class="st10"
                                             points="3.1,293.7 3.1,298.4 152.7,298.4 152.7,293.7"/>
                                    <polygon id="PerfilPux-Base-detalhe"
                                             points="3.1,298.4 3.1,301.57 152.7,301.57 152.7,298.4"/>
                                </g>
                                <g id="PerfilPux-Direita" class="st2" fill="#151618">
                                    <polygon id="PerfilPux-Direita-Cava" class="st10"
                                             points="152.7,57 152.7,293.7 157.4,293.7 157.4,57"/>
                                    <polygon id="PerfilPux-Direita-detalhe"
                                             points="157.4,57 157.4,293.7 160.57,293.7 160.57,57"/>
                                </g>
                                <g id="PerfilPux-Topo" class="st2" fill="#151618">
                                    <polygon id="PerfilPux-Topo-Cava" class="st10"
                                             points="3.1,52.3 3.1,57 152.7,57 152.7,52.3"/>
                                    <polygon id="PerfilPux-Topo-detalhe"
                                             points="3.1,49.13 3.1,52.3 152.7,52.3 152.7,49.13"/>
                                </g>
                            </g>
                            <g id="MedidaDesenho" class="st2">
                                <g id="Tamanho-A">
                                    <text id="texto-largura" transform="matrix(1 0 0 1 60.6856 356)"
                                          class="st7 st8">
                                    </text>
                                    <polygon id="medida-largura" points="-4.77,334.2 -4.77,349 -3.07,349 -3.07,342.9 158.87,342.9 158.87,349 160.57,349 160.57,334.2
                                                                       158.87,334.2 158.87,340.3 -3.07,340.3 -3.07,334.2"/>
                                </g>
                                <g id="Tamanho-B">
                                    <text id="texto-altura"
                                          transform="matrix(-1.346898e-10 1 -1 -1.346898e-10 205 158)"
                                          class="st7 st8">
                                    </text>
                                    <polygon id="medida-altura"
                                             points="193.2,49.13 193.2,50.83 199.3,50.83 199.3,299.87 193.2,299.87 193.2,301.57 208,301.57 208,299.87 201.9,299.87 201.9,50.83 208,50.83 208,49.13"/>
                                </g>
                            </g>
                        </g>
                    </g>
                </svg>
            </div>
        </div>
    </div>
<!--====================  TABELAS =======================-->
    <div class="container container-flex">
        <div class="table-container border rounded justify-content-start col-6 me-2 mt-2 table-responsive coluna1">
            <header>
                <h2 class="bg-warning text-dark text-center fs-6 fw-bold">Insumos</h2>
                <table class="table table-bordered table-sm" id="tabelaInsumos">
                    <thead class="table-active">
                        <tr>
                          <th scope="col">Id</th>
                          <th scope="col">Código</th>
                          <th scope="col">Descrição</th>
                          <th scope="col">Quant(m)</th>
                          <th scope="col">Valor</th>
                          <th scope="col">Subtotal</th>
                        </tr>
                    </thead>
                    <tbody class="table-group-divider">
                    </tbody>
                </table>
            </header>
        </div>
        <div class="table-container border rounded justify-content-start col-6 me-2 mt-2 table-responsive coluna2">
            <header>
                <h2 class="bg-warning text-dark text-center fs-6 fw-bold">Itens do Orçamento</h2>
                <table class="table table-bordered table-sm" id="tabelaOrcamento">
                        <thead class="table-active">
                            <tr>
                              <th scope="col">Id</th>
                              <th scope="col">Qt</th>
                              <th scope="col">Descrição</th>
                              <th scope="col">Valor</th>
                              <th scope="col"></th>
                            </tr>
                        </thead>
                        <tbody class="table-group-divider">
                        </tbody>
                    </table>
            </header>
        </div>
    </div>
</div>
<nav id="bottom-navbar" class="navbar-dark bg-dark">
  <div class="container d-flex">
      <div class="d-flex justify-content-end align-items-center flex-grow-1 me-2">
          <label class="st2" id="labeldototal">R$</label>
          <span id="valorfinalpedido"></span>
          <button type="button" class="btn btn-primary btn-sm ml-3">Finalizar</button>
      </div>
  </div>
</nav>

<script>
    const larguraInput = document.getElementById("id_largura");
    const alturaInput = document.getElementById("id_altura");

    larguraInput.addEventListener("input", formatarValor);
    alturaInput.addEventListener("input", formatarValor);

    function formatarValor(event) {
        const input = event.target;
        let valor = input.value;

        // Remova qualquer não número e ponto decimal adicional
        valor = valor.replace(/[^0-9.]/g, '');

        // Separe os valores inteiros e decimais
        const partes = valor.split('.');
        let parteInteira = partes[0];
        let parteDecimal = partes[1] || '';

        // Limita a parte inteira a 4 dígitos (9.999)
        if (parteInteira.length > 4) {
            parteInteira = parteInteira.slice(0, 4);
        }

        // Limita a parte decimal a 3 dígitos
        if (parteDecimal.length > 3) {
            parteDecimal = parteDecimal.slice(0, 3);
        }

        // Formata novamente com a parte decimal
        valor = parteInteira + (parteDecimal ? '.' + parteDecimal : '');

        // Se o valor formatado não for um número válido, use o valor anterior
        if (isNaN(parseFloat(valor))) {
            valor = input.value;
        }

        input.value = valor;
    }
</script>

<script>
$(document).ready(function() {
  function atualizarPosicoesPerfilPuxador() {
    var qtdPerfilPuxador = $("#qtd-perfilpuxador").val();
    var perfilPuxador = $("#id_perfilpuxador").val();
    var abertura = $("#id_abertura").val();
    var posicaoPerfilPuxador = $("#posicao-perfilpuxador");

    posicaoPerfilPuxador.empty();

    if (qtdPerfilPuxador === "2") {
      if ($("#btnPortaCorrer").is(":checked")) {
        posicaoPerfilPuxador.append($('<option>', {value: 'Esq/Dir', text: 'Esq/Dir'}));
      }
    } else if (qtdPerfilPuxador === "1") {
        if ($("#btnPortaCorrer").is(":checked")) {
          posicaoPerfilPuxador.append($('<option>', {value: 'Direita', text: 'Direita'}));
          posicaoPerfilPuxador.append($('<option>', {value: 'Esquerda', text: 'Esquerda'}));
        } else if ($("#btnPortaGiro").is(":checked")) {
            if (abertura === "D") {
              posicaoPerfilPuxador.append($('<option>', {value: 'Esquerda', text: 'Esquerda'}));
              posicaoPerfilPuxador.append($('<option>', {value: 'Topo', text: 'Topo'}));
              posicaoPerfilPuxador.append($('<option>', {value: 'Base', text: 'Base'}));
            } else if (abertura === "E") {
              posicaoPerfilPuxador.append($('<option>', {value: 'Direita', text: 'Direita'}));
              posicaoPerfilPuxador.append($('<option>', {value: 'Topo', text: 'Topo'}));
              posicaoPerfilPuxador.append($('<option>', {value: 'Base', text: 'Base'}));
            } else if (abertura === "C") {
              posicaoPerfilPuxador.append($('<option>', {value: 'Base', text: 'Base'}));
            } else if (abertura === "B") {
              posicaoPerfilPuxador.append($('<option>', {value: 'Topo', text: 'Topo'}));
            }
        }
    }
  }

  function atualizarQtdPerfilPuxador() {
    var perfilPuxador = $("#id_perfilpuxador").val();
    var qtdPerfilPuxador = $("#qtd-perfilpuxador");

    qtdPerfilPuxador.empty();

    if ($("#btnPortaGiro").is(":checked")) {
      if (perfilPuxador && perfilPuxador !== "") {
        qtdPerfilPuxador.append($('<option>', {value: '1', text: '1'}));
      }
    } else if ($("#btnPortaCorrer").is(":checked")) {
      if (perfilPuxador && perfilPuxador !== "") {
        qtdPerfilPuxador.append($('<option>', {value: '1', text: '1'}));
        qtdPerfilPuxador.append($('<option>', {value: '2', text: '2'}));
      }
    }
  }

  $("#id_perfilpuxador").change(function() {
    atualizarQtdPerfilPuxador();
    atualizarPosicoesPerfilPuxador();
  });

  $("#qtd-perfilpuxador").change(function() {
    atualizarPosicoesPerfilPuxador();
  });

  $("#id_abertura").change(function() {
    atualizarPosicoesPerfilPuxador();
  });

  $("input[name='btnradio']").change(function() {
    atualizarQtdPerfilPuxador();
    atualizarPosicoesPerfilPuxador();
  });
});
</script>

<script>
$(document).ready(function() {
  function atualizarPosicoesPuxador() {
    var qtdPuxador = $("#qtd-puxador").val();
    var Puxador = $("#id_puxador").val();
    var abertura = $("#id_abertura").val();
    var posicaoPuxador = $("#posicao-puxador");

    posicaoPuxador.empty();

    if (qtdPuxador === "2") {
      if ($("#btnPortaCorrer").is(":checked")) {
        posicaoPuxador.append($('<option>', {value: 'Esq/Dir', text: 'Esq/Dir'}));
      }
    } else if (qtdPuxador === "1") {
        if ($("#btnPortaCorrer").is(":checked")) {
          posicaoPuxador.append($('<option>', {value: 'Direita', text: 'Direita'}));
          posicaoPuxador.append($('<option>', {value: 'Esquerda', text: 'Esquerda'}));
        } else if ($("#btnPortaGiro").is(":checked")) {
            if (abertura === "D") {
              posicaoPuxador.append($('<option>', {value: 'Esquerda', text: 'Esquerda'}));
              posicaoPuxador.append($('<option>', {value: 'Topo', text: 'Topo'}));
              posicaoPuxador.append($('<option>', {value: 'Base', text: 'Base'}));
            } else if (abertura === "E") {
              posicaoPuxador.append($('<option>', {value: 'Direita', text: 'Direita'}));
              posicaoPuxador.append($('<option>', {value: 'Topo', text: 'Topo'}));
              posicaoPuxador.append($('<option>', {value: 'Base', text: 'Base'}));
            } else if (abertura === "C") {
              posicaoPuxador.append($('<option>', {value: 'Base', text: 'Base'}));
            } else if (abertura === "B") {
              posicaoPuxador.append($('<option>', {value: 'Topo', text: 'Topo'}));
            }
        }
    }
  }

  function atualizarQtdPuxador() {
    var Puxador = $("#id_puxador").val();
    var qtdPuxador = $("#qtd-puxador");

    qtdPuxador.empty();

    if ($("#btnPortaGiro").is(":checked")) {
      if (Puxador && Puxador !== "") {
        qtdPuxador.append($('<option>', {value: '1', text: '1'}));
      }
    } else if ($("#btnPortaCorrer").is(":checked")) {
      if (Puxador && Puxador !== "") {
        qtdPuxador.append($('<option>', {value: '1', text: '1'}));
        qtdPuxador.append($('<option>', {value: '2', text: '2'}));
      }
    }
  }

  $("#id_puxador").change(function() {
    atualizarQtdPuxador();
    atualizarPosicoesPuxador();
  });

  $("#qtd-puxador").change(function() {
    atualizarPosicoesPuxador();
  });

  $("#id_abertura").change(function() {
    atualizarPosicoesPuxador();
  });

  $("input[name='btnradio']").change(function() {
    atualizarQtdPuxador();
    atualizarPosicoesPuxador();
  });
});
</script>

<!--=============== BUSCAR ======================-->

<script>

function filtrarPerfil() {
var acabamento = parseInt($('#id_acabamento').val(), 10);
var quantidade = $('#id_quantidade').val();
var largura = $('#id_largura').val();
var altura = $('#id_altura').val();
var abertura = $('#id_abertura').val();
var perfilField = $('#id_perfil');
var perfilDiv = $('#divperfil');
var campoPortas = $('#divportas');
var portaGiroRadioButton = $('#btnPortaGiro');
var portaCorrerRadioButton = $('#btnPortaCorrer');

// Verificar se o radiobutton selecionado é PortaGiro
if (portaGiroRadioButton.is(':checked')) {
  if (quantidade && largura && altura && acabamento && abertura) {
    perfilField.prop('disabled', false);
    perfilDiv.find(':input').prop('disabled', false);

    $.ajax({
      url: '/buscar_perfil/',
      type: 'GET',
      data: {
        acabamento: acabamento
      },
      success: function(response) {
        perfilField.empty();

        var option = $('<option>').attr('value', '').text('-------');
        perfilField.append(option);

        $.each(response, function(index, item) {
          option = $('<option>').attr('value', item.id).text(item.descricao);
          option.data('item', item); // Armazena o objeto completo como dado associado
          perfilField.append(option);
        });

        perfilField.show();

      },
      error: function(xhr) {
        console.log(xhr.statusText);
      }
    });
  } else {
    campoPortas.prop('disabled', true);
    campoPortas.find(':input').prop('disabled', true);
    perfilField.empty();
  }
} else if (portaCorrerRadioButton.is(':checked')) {
  if (quantidade && largura && altura && acabamento) {
    perfilField.prop('disabled', false);
    perfilDiv.find(':input').prop('disabled', false);

    $.ajax({
      url: '/buscar_perfil/',
      type: 'GET',
      data: {
        acabamento: acabamento
      },
      success: function(response) {
        perfilField.empty();

        var option = $('<option>').attr('value', '').text('-------');
        perfilField.append(option);

        $.each(response, function(index, item) {
          option = $('<option>').attr('value', item.id).text(item.descricao);
          option.data('item', item); // Armazena o objeto completo como dado associado
          perfilField.append(option);
        });

        perfilField.show();
      },
      error: function(xhr) {
        console.log(xhr.statusText);
      }
    });
  }
} else {
  // Manter o campo perfil bloqueado para outros radiobuttons selecionados
  perfilField.prop('disabled', true);
  perfilDiv.find(':input').prop('disabled', true);
  perfilField.empty();
}
}

// Chamar a função filtrarPerfil inicialmente
filtrarPerfil();

$('#id_acabamento, #id_quantidade, #id_largura, #id_altura, #id_abertura').change(filtrarPerfil);

</script>

<script>
$(document).ready(function() {
  $('#id_perfil').change(function() {
    buscarPerfilPuxador();
  });

  function buscarPerfilPuxador() {
    var perfil = $('#id_perfil').val();

    if (perfil) {
      $.ajax({
        url: '/buscar_PerfilPuxador/',
        type: 'GET',
        data: {
          perfil: perfil
        },
        success: function(response) {
          var selectPerfilPuxador = $('#id_perfilpuxador');
          selectPerfilPuxador.empty();

          var option = $('<option>').attr('value', '').text('-------');
          selectPerfilPuxador.append(option);

          $.each(response, function(index, item) {
              option = $('<option>').attr('value', item.id).text(item.descricao);
              option.data('item', item); // Armazenar o objeto completo como dado associado
              selectPerfilPuxador.append(option);
          });


          var numItens = response.length;

          if (numItens <= 0) {
            selectPerfilPuxador.prop('disabled', true);
            $('#divperfilpuxador :input').prop('disabled', true);
          } else {
            selectPerfilPuxador.prop('disabled', false);
            $('#divperfilpuxador :input').prop('disabled', false);
          }

          selectPerfilPuxador.show();
        },
        error: function(xhr) {
          console.log(xhr.statusText);
        }
      });
    } else {
      $('#id_perfilpuxador').empty();
      $('#divperfilpuxador :input').prop('disabled', true);
    }
  }
});
</script>

<script>
$(document).ready(function() {
  $('#id_perfil').change(function() {
    buscarPuxador();
  });

  function buscarPuxador() {
    var perfil = $('#id_perfil').val();

    if (perfil) {
      $.ajax({
        url: '/buscar_Puxador/',
        type: 'GET',
        data: {
          perfil: perfil
        },
        success: function(response) {
          var selectPuxador = $('#id_puxador');
          selectPuxador.empty();

          var option = $('<option>').attr('value', '').text('-------');
          selectPuxador.append(option);

          $.each(response, function(index, item) {
            var option = $('<option>').attr('value', item.id).text(item.descricao);
            option.data('item', item); // Armazenar o objeto completo como dado associado
            selectPuxador.append(option); // Corrigido de selectPerfilPuxador para selectPuxador
        });


          var numItens = response.length;

          if (numItens <= 0) {
            selectPuxador.prop('disabled', true);
            $('#divpuxador :input').prop('disabled', true);
          } else {
            selectPuxador.prop('disabled', false);
            $('#divpuxador :input').prop('disabled', false);
          }

          selectPuxador.show();
        },
        error: function(xhr) {
          console.log(xhr.statusText);
        }
      });
    } else {
      $('#id_puxador').empty();
      $('#divpuxador :input').prop('disabled', true);
    }
  }
});
</script>

<script>
$(document).ready(function() {
  $('#id_perfil').change(function() {
    limparCamposPortas();
    buscarDivisor();
    limparCampoVidro();
  });

  function buscarDivisor() {
    var perfil = $('#id_perfil').val();

    if (perfil) {
      $.ajax({
        url: '/buscar_Divisor/',
        type: 'GET',
        data: {
          perfil: perfil
        },
        success: function(response) {
          var selectDivisor = $('#id_divisor');
          selectDivisor.empty();

          var option = $('<option>').attr('value', '').text('-------');
          selectDivisor.append(option);

          $.each(response, function(index, item) {
            option = $('<option>').attr('value', item.id).text(item.descricao);
            option.data('item', item); // Armazenar o objeto completo como dado associado
            selectDivisor.append(option);
          });

          var numItens = response.length;

          if (numItens <= 0) {
            selectDivisor.prop('disabled', true);
            $('#divdivisor :input').prop('disabled', true);
          } else {
            selectDivisor.prop('disabled', false);
            $('#divdivisor :input').prop('disabled', false);
          }

          selectDivisor.show();
        },
        error: function(xhr) {
          console.log(xhr.statusText);
        }
      });
    } else {
      $('#id_divisor').empty();
      $('#divdivisor :input').prop('disabled', true);
    }
  }

  function limparCamposPortas() {
    $('#divportas input:not(#id_perfil), #divportas select:not(#id_perfil)').each(function() {
      $(this).val('').prop('disabled', true);
    });
  }

  // Função para limpar o campo id_vidro
  function limparCampoVidro() {
    $('#id_vidro').val('');
  }
});

</script>

<script>
$(document).ready(function () {
  $('#id_perfil').change(function () {
    buscarVidros();
  });

  // Manipuladores de eventos para id_vidro1, id_vidro2 e id_vidro3
  $('#id_vidro1').change(function () {
    acessarDadosVidro($(this));
  });

  $('#id_vidro2').change(function () {
    acessarDadosVidro($(this));
  });

  $('#id_vidro3').change(function () {
    acessarDadosVidro($(this));
  });

  function buscarVidros() {
    var perfil = $('#id_perfil').val();

    if (perfil) {
      var vidrosElementos = $('#id_vidro, #id_vidro1, #id_vidro2, #id_vidro3');

      var vidros = vidrosElementos.map(function() {
        return $(this).val();
      }).get().join(',');

      $.ajax({
        url: '/buscar_Vidro/',
        type: 'GET',
        data: {
          vidro: vidros
        },
        success: function (response) {
          var option = $('<option>').attr('value', '').text('-------');

          vidrosElementos.empty().append(option);

          $.each(response, function (index, item) {
            var option = $('<option>').attr('value', item.id).text(item.descricao);
            option.data('id', item.id);
            option.data('codigo', item.codigo);
            option.data('nome', item.nome);
            option.data('descricao', item.descricao);
            option.data('nome', item.nome);
            option.data('preco', item.preco);
            option.data('modelo', item.modelo);

            vidrosElementos.append(option);
          });

          var numItens = response.length;

          if (numItens <= 0) {
            $('#id_vidro1, #id_vidro2, #id_vidro3').prop('disabled', true);
            $('.st2 :input').prop('disabled', true);
          } else {
            $('#id_vidro1, #id_vidro2, #id_vidro3').prop('disabled', false);
            $('.st2 :input').prop('disabled', false);
          }
        },
        error: function (xhr) {
          console.log(xhr.statusText);
        }
      });
    } else {
      $('#id_vidro, #id_vidro1, #id_vidro2, #id_vidro3').empty();
      $('.st2 :input').prop('disabled', true);
    }
  }

  // Função para acessar os dados de cada vidro individualmente
  function acessarDadosVidro(elemento) {
    var vidroDescricao = elemento.find('option:selected').data('descricao') || '';
  }
});

</script>

<!--=============== END BUSCAR ======================-->

<script>
$(document).ready(function() {
  $('#id_acabamento, #id_abertura, #id_largura, #id_altura, #id_quantidade').change(function() {
    // Limpar e bloquear os campos da divportas, exceto o campo perfil
    $('#divportas input:not(#id_perfil), #divportas select:not(#id_perfil)').val('').prop('disabled', true);

    // Verificar se os campos obrigatórios estão preenchidos
    var quantidade = $('#id_quantidade').val();
    var largura = $('#id_largura').val();
    var altura = $('#id_altura').val();
    var acabamento = $('#id_acabamento').val();
    var abertura = $('#id_abertura').val();

    if ($('#btnPortaGiro').is(':checked')) {
        if (quantidade && largura && altura && acabamento && abertura) {
          // Desbloquear o campo perfil
          $('#id_perfil').prop('disabled', false);
        }
    }
    if ($('#btnPortaCorrer').is(':checked')) {
        if (quantidade && largura && altura && acabamento) {
          // Desbloquear o campo perfil
          $('#id_perfil').prop('disabled', false);
        }
    }
  });
});
</script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    var btnPortaGiro = document.getElementById('btnPortaGiro');
    var btnPortaCorrer = document.getElementById('btnPortaCorrer');
    var btnVidro = document.getElementById('btnVidro');
    var campoLinha = document.getElementById('divlinha');
    var campoAcabamento = document.getElementById('divacabamento');
    var campoAbertura = document.getElementById('divabertura');
    var campoPorta = document.getElementById('divportas');
    var campoVidro = document.getElementById('divvidros');

    btnPortaGiro.addEventListener('change', function() {
      limparCampos();
      campoAcabamento.classList.remove('d-none');
      campoAbertura.classList.remove('d-none');
      campoPorta.classList.remove('hidden');
      campoVidro.classList.add('hidden');
    });

    btnPortaCorrer.addEventListener('change', function() {
      limparCampos();
      campoAbertura.classList.add('d-none');
      campoAcabamento.classList.remove('d-none');
      campoPorta.classList.remove('hidden');
      campoVidro.classList.add('hidden');
    });

    btnVidro.addEventListener('change', function() {
      limparCampos();
      campoAbertura.classList.add('d-none');
      campoAcabamento.classList.add('d-none');
      campoPorta.classList.add('hidden');
      campoVidro.classList.remove('hidden');
    });

    function limparCampos() {
      var camposPorta = document.getElementById('divportas').getElementsByTagName('input');
      var selectsPorta = document.getElementById('divportas').getElementsByTagName('select');

      for (var i = 0; i < camposPorta.length; i++) {
        camposPorta[i].value = '';
        camposPorta[i].disabled = true;
      }
      for (var i = 0; i < selectsPorta.length; i++) {
        selectsPorta[i].value = '';
        selectsPorta[i].disabled = true;
      }

      var camposVidro = document.getElementById('divvidros').getElementsByTagName('input');
      var selectsVidro = document.getElementById('divvidros').getElementsByTagName('select');

      for (var i = 0; i < camposVidro.length; i++) {
        camposVidro[i].value = '';
        camposVidro[i].disabled = true;
      }
      for (var i = 0; i < selectsVidro.length; i++) {
        selectsVidro[i].value = '';
      }

      var campoAcabamento = document.getElementById('id_acabamento');
      var campoAbertura = document.getElementById('id_abertura');

      campoAcabamento.value = '';
      campoAcabamento.disabled = false;

      campoAbertura.value = '';
      campoAbertura.disabled = false;

    }
  });
</script>

<script>
  $(document).ready(function() {
    $("#id_perfilpuxador").change(function() {
      var perfilPuxador = $(this).val();
      var puxadorField = $("#id_puxador");
      var qtdpuxadorField = $("#qtd-puxador");
      var posicaopuxadorField = $("#posicao-puxador");
      var tamanhopuxadorField = $("#tam-puxador");

      if (perfilPuxador && perfilPuxador !== "") {
      puxadorField.prop('disabled', true);
      qtdpuxadorField.prop('disabled', true);
      posicaopuxadorField.prop('disabled', true);
      tamanhopuxadorField.prop('disabled', true);
      } else {
        if (puxadorField.children().length > 1) {
            puxadorField.prop('disabled', false);
            qtdpuxadorField.prop('disabled', false);
            posicaopuxadorField.prop('disabled', false);
            tamanhopuxadorField.prop('disabled', false);
        }
      }

      // Clear the related fields
      $("#qtd-perfilpuxador").val('');
      $("#posicao-perfilpuxador").val('');
    });

    $("#id_puxador").change(function() {
      var puxador = $(this).val();
      var perfilPuxadorField = $("#id_perfilpuxador");
      var qtdperfilPuxadorField = $("#qtd-perfilpuxador");
      var posicaoperfilPuxadorField = $("#posicao-perfilpuxador");

      if (puxador && puxador !== "") {
      perfilPuxadorField.prop('disabled', true);
      qtdperfilPuxadorField.prop('disabled', true);
      posicaoperfilPuxadorField.prop('disabled', true);
      } else {
        if (perfilPuxadorField.children().length > 1) {
            perfilPuxadorField.prop('disabled', false);
            qtdperfilPuxadorField.prop('disabled', false);
            posicaoperfilPuxadorField.prop('disabled', false);
        }
      }

      $("#qtd-puxador").val('');
      $("#posicao-puxador").val('');
      $("#tam-puxador").val('');
    });

    $("#id_perfil").change(function() {
      var perfil = $(this).val();
      var campoVidro = $("#id_vidro");

      if (perfil && perfil !== "") {
        campoVidro.prop('disabled', false);
      } else {
        campoVidro.prop('disabled', true);
      }
    });
  });
</script>

<script>
$(document).ready(function() {

  $("#id_divisor").change(function() {
    var divisor = $(this).val();
    var qtdDivisor = $("#qtd-divisor");

    qtdDivisor.empty();

    if (divisor && divisor !== "") {
      qtdDivisor.empty();
      qtdDivisor.append($('<option>', {value: '1', text: '1'}));
      qtdDivisor.append($('<option>', {value: '2', text: '2'}));
      qtdDivisor.prop('disabled', false);
    }
  });
});
</script>

<script>
$(document).ready(function() {
  // Funções reutilizáveis
  function carregarOpcoes(selectElement, data) {
    selectElement.empty();
    var option = $('<option>').attr('value', '').text('-------');
    selectElement.append(option);

    if (data.length > 0) {
      $.each(data, function(index, item) {
        option = $('<option>').attr('value', item.id).text(item.descricao);
        selectElement.append(option);
      });

      selectElement.prop('disabled', false);
      selectElement.show();
    } else {
      selectElement.prop('disabled', true);
    }
  }

  function realizarRequisicao(url, params, successCallback) {
    $.ajax({
      url: url,
      type: 'GET',
      data: params,
      success: successCallback,
      error: function(xhr) {
        console.log(xhr.statusText);
      }
    });
  }

  // Obter acabamentos
  $('#btnPortaGiro, #btnPortaCorrer').change(obterAcabamentos);
  obterAcabamentos();

  function obterAcabamentos() {
    realizarRequisicao('/obter_acabamentos/', {}, function(response) {
      var selectAcabamento = $('#id_acabamento');
      selectAcabamento.empty();

      if (response.acabamentos.length > 0) {
        $.each(response.acabamentos, function(index, item) {
          var option = $('<option>').attr('value', item.id).text(item.acabamento);
          selectAcabamento.append(option);
        });

        selectAcabamento.prop('disabled', false);
        selectAcabamento.show();
      } else {
        selectAcabamento.prop('disabled', true);
        selectAcabamento.hide();
      }
    });
  }
});
</script>

<script>
$(document).ready(function () {
    $('#id_acabamento').on('change', function () {
        var acabamentoID = $(this).val();

        $.ajax({
            type: 'GET',
            url: '{% url "obter_codigo_rgb" %}',
            data: {
                acabamento_id: acabamentoID
            },
            success: function (response) {
                console.log('Evento de mudança disparado!');
                var svgElement = $('#svg');

                // Atualizar o atributo fill da classe st0 do SVG com o código RGB recebido
                $('#Perfis').attr('fill', response.codigo_rgb);
                $('#Acabamento').attr('fill', response.codigo_rgb);
                $('#PerfilPux-Topo').attr('fill', response.codigo_rgb);
                $('#PerfilPux-Direita').attr('fill', response.codigo_rgb);
                $('#PerfilPux-Base').attr('fill', response.codigo_rgb);
                $('#PerfilPux-Esquerda').attr('fill', response.codigo_rgb);
                console.log(response.codigo_rgb);
            },
            error: function (xhr, status, error) {
                console.error(error);
            }
        });
    });
});
</script>

<script>
  $(document).ready(function() {

    function atualizarPosicoesPerfilPuxador() {
      // Verificar se os campos obrigatórios estão preenchidos
      var larguraPreenchida = $('#id_largura').val() !== "";
      var alturaPreenchida = $('#id_altura').val() !== "";
      var perfilPuxadorPreenchido = $('#id_perfilpuxador').val() !== "";

      var posicaoPerfilPuxador = $("#posicao-perfilpuxador").val();

      // Remover classes st6 e st9 de todos os elementos
      $("#PerfilPux-Topo, #PerfilPux-Direita, #PerfilPux-Base, #PerfilPux-Esquerda")
        .removeClass("st6 st9");
      $("#perfil_superior, #perfil_direita, #perfil_inferior, #perfil_esquerda")
        .removeClass("st9");

      if (larguraPreenchida && alturaPreenchida && perfilPuxadorPreenchido) {
        var posicaoPerfilPuxador = $("#posicao-perfilpuxador").val();
        var larguraMaiorQueAltura = parseFloat($('#id_largura').val()) > parseFloat($('#id_altura').val());
        var largura = parseFloat($('#id_largura').val());
        var altura = parseFloat($('#id_altura').val());

        if (posicaoPerfilPuxador === "") {
          // Remover classes st6 e st9 dos elementos
          $("#PerfilPux-Topo, #PerfilPux-Direita, #PerfilPux-Base, #PerfilPux-Esquerda")
            .removeClass("st6 st9");
          $("#perfil_superior, #perfil_direita, #perfil_inferior, #perfil_esquerda")
            .removeClass("st9");
        } else {
          // Remover classes st6 e st9 dos elementos
          $("#PerfilPux-Topo, #PerfilPux-Direita, #PerfilPux-Base, #PerfilPux-Esquerda")
            .removeClass("st6 st9");

          // Remover classe st9 dos demais elementos
          $("#perfil_superior, #perfil_direita, #perfil_inferior, #perfil_esquerda")
            .removeClass("st9");

          // Adicionar classes st6 e st9 com base nas condições
            if (posicaoPerfilPuxador === "Esquerda") {
              $("#PerfilPux-Esquerda").addClass("st6 st9");
              $("#perfil_esquerda").addClass("st9");
            } else if (posicaoPerfilPuxador === "Topo") {
              $("#PerfilPux-Topo").addClass("st6 st9");
              $("#perfil_superior").addClass("st9");
            } else if (posicaoPerfilPuxador === "Base") {
              $("#PerfilPux-Base").addClass("st6 st9");
              $("#perfil_inferior").addClass("st9");
            } else if (posicaoPerfilPuxador === "Direita") {
              $("#PerfilPux-Direita").addClass("st6 st9");
              $("#perfil_direita").addClass("st9");
            } else if (posicaoPerfilPuxador === "Esq/Dir") {
              $("#PerfilPux-Esquerda, #PerfilPux-Direita").addClass("st6 st9");
              $("#perfil_esquerda, #perfil_direita").addClass("st9");
            }
        }
      }
    }

    // Eventos de mudança para chamar a função
    $("#posicao-perfilpuxador").on('input', atualizarPosicoesPerfilPuxador);
    $("#id_perfilpuxador, #id_perfil, #id_acabamento, #id_quantidade, #qtd-perfilpuxador, #id_largura, #id_altura, #id_abertura, input[name='btnradio']").change(atualizarPosicoesPerfilPuxador);
  });


</script>

<script>
$(document).ready(function() {
function atualizarPosicoesPuxador() {

    $('#Puxador-Esquerda, #Puxador-Base, #Puxador-Direita, #Puxador-Topo').removeClass('st6');

    var posicaoPuxador = $("#posicao-puxador").val();
    var tamPuxador = parseFloat($("#tam-puxador").val());
    var largura = parseFloat($('#id_largura').val());
    var altura = parseFloat($('#id_altura').val());

    if (tamPuxador !== "") {
      if (posicaoPuxador === "Esquerda") {
        if (tamPuxador < altura) {
          $(".pux").removeClass("st6");
          $("#Puxador-Esquerda").addClass("st6");
          $("#Puxador-Esquerda-int").removeClass("st6");
          $("#Puxador-Esquerda-int").addClass("st2");
          $("#Puxador-Esquerda-trecho").addClass("st6");
        } else {
          $(".pux").removeClass("st6");
          $("#Puxador-Esquerda").addClass("st6");
          $("#Puxador-Esquerda-int").addClass("st6");
          $("#Puxador-Esquerda-trecho").removeClass("st6");
        }
      } else if (posicaoPuxador === "Topo") {
        if (tamPuxador < largura) {
          $(".pux").removeClass("st6");
          $("#Puxador-Topo").addClass("st6");
          $("#Puxador-Topo-int").removeClass("st6");
          $("#Puxador-Topo-int").addClass("st2");
          $("#Puxador-Topo-trecho").addClass("st6");
        } else {
          $(".pux").removeClass("st6");
          $("#Puxador-Topo").addClass("st6");
          $("#Puxador-Topo-int").addClass("st6");
          $("#Puxador-Topo-trecho").removeClass("st6");
        }
      } else if (posicaoPuxador === "Base") {
        if (tamPuxador < largura) {
          $(".pux").removeClass("st6");
          $("#Puxador-Base").addClass("st6");
          $("#Puxador-Base-int").removeClass("st6");
          $("#Puxador-Base-int").addClass("st2");
          $("#Puxador-Base-trecho").addClass("st6");
        } else {
          $(".pux").removeClass("st6");
          $("#Puxador-Base").addClass("st6");
          $("#Puxador-Base-int").addClass("st6");
          $("#Puxador-Base-trecho").removeClass("st6");
        }
      } else if (posicaoPuxador === "Direita") {
        if (tamPuxador < altura) {
          $(".pux").removeClass("st6");
          $("#Puxador-Direita").addClass("st6");
          $("#Puxador-Direita-int").removeClass("st6");
          $("#Puxador-Direita-int").addClass("st2");
          $("#Puxador-Direita-trecho").addClass("st6");
        } else {
          $(".pux").removeClass("st6");
          $("#Puxador-Direita").addClass("st6");
          $("#Puxador-Direita-int").addClass("st6");
          $("#Puxador-Direita-trecho").removeClass("st6");
        }
      } else if (posicaoPuxador === "Esq/Dir") {
        if (tamPuxador < altura) {
          $(".pux").removeClass("st6");
          $("#Puxador-Esquerda, #Puxador-Direita").addClass("st6");
          $("#Puxador-Esquerda-int, #Puxador-Direita-int").removeClass("st6");
          $("#Puxador-Esquerda-int, #Puxador-Direita-int").addClass("st2");
          $("#Puxador-Esquerda-trecho, #Puxador-Direita-trecho").addClass("st6");
        } else {
          $(".pux").removeClass("st6");
          $("#Puxador-Esquerda, #Puxador-Direita").addClass("st6");
          $("#Puxador-Esquerda-int, #Puxador-Direita-int").addClass("st6");
          $("#Puxador-Esquerda-trecho, #Puxador-Direita-trecho").removeClass("st6");
        }
      }
    } else {
      $(".pux").removeClass("st6");
    }
  }

  // Evento 'input' para campo posicao-puxador
  $("#posicao-puxador").on('input', function() {
    atualizarPosicoesPuxador();
  });

  $("#tam-puxador").on('input', function() {
    atualizarPosicoesPuxador();
  });

  $("#id_puxador").change(function() {
    atualizarPosicoesPuxador();
  });

  $("#id_perfil").change(function() {
    atualizarPosicoesPuxador();
  });

  $("#id_acabamento").change(function() {
    atualizarPosicoesPuxador();
  });

  $("#id_quantidade").change(function() {
    atualizarPosicoesPuxador();
  });

  $("#qtd-puxador").change(function() {
    atualizarPosicoesPuxador();
  });

  $("#id_largura").change(function() {
    atualizarPosicoesPuxador();
  });

  $("#id_altura").change(function() {
    atualizarPosicoesPuxador();
  });

  $("#id_abertura").change(function() {
    $("#posicao-puxador").val("");
    atualizarPosicoesPuxador();
  });

  $("input[name='btnradio']").change(function() {
    $("#posicao-puxador").val("");
    atualizarPosicoesPuxador();
  });

});

</script>

<script>
$(document).ready(function() {
  function atualizarPosicoesDivisor() {
    var qtdDivisor = $("#qtd-divisor").val();
    var tipoDivisor = $('#id_divisor option:selected').data('item')?.tipodivisor ?? '';

    if (qtdDivisor === "1" ) {
      $("#Divisor-A, #Divisor-B, #Divisor-C").removeClass("st6");
      $("#Divisor-B").addClass("st6");
      if (tipoDivisor === "Aparente") {
          $("#divvidro1, #divvidro2, #divvidro3").addClass("st2");
          $("#divvidro").addClass("st2");
          $("#divvidro1, #divvidro2").removeClass("st2");
          $("#id_vidro1, #id_vidro2").prop("disabled", false);
      } else if (tipoDivisor === "Oculto") {
          $("#divvidro1, #divvidro2, #divvidro3").addClass("st2");
          $("#divvidro").addClass("st2");
          $("#divvidro").removeClass("st2");
          $("#id_vidro").prop("disabled", false);
      }
    } else if (qtdDivisor === "2") {
      $("#Divisor-A, #Divisor-B, #Divisor-C").removeClass("st6");
      $("#Divisor-A, #Divisor-C").addClass("st6");
      if (tipoDivisor === "Aparente") {
          $("#divvidro").addClass("st2");
          $("#divvidro1, #divvidro2, #divvidro3").removeClass("st2");
          $("#id_vidro1, #id_vidro2, #id_vidro3").prop("disabled", false);
      } else if (tipoDivisor === "Oculto") {
          $("#divvidro").addClass("st2");
          $("#divvidro").removeClass("st2");
          $("#id_vidro").prop("disabled", false);
      }
    } else {
      $("#Divisor-A, #Divisor-B, #Divisor-C").removeClass("st6");
      $("#divvidro1, #divvidro2, #divvidro3").removeClass("st6");
      $("#divvidro1, #divvidro2, #divvidro3").addClass("st2");
      $("#divvidro").removeClass("st2");
      }
  }

  $("#qtd-divisor").on('input', function() {
    atualizarPosicoesDivisor();
  });

  $("#id_divisor").on('change', function() {
    atualizarPosicoesDivisor();
  });

  $("#id_puxador").change(function() {
    atualizarPosicoesDivisor();
  });

  $("#id_perfil").change(function() {
    atualizarPosicoesDivisor();
  });

  $("#id_acabamento").change(function() {
    atualizarPosicoesDivisor();
  });

  $("#id_quantidade").change(function() {
    atualizarPosicoesDivisor();
  });

  $("#qtd-puxador").change(function() {
    atualizarPosicoesDivisor();
  });

  $("#id_largura").change(function() {
    atualizarPosicoesDivisor();
  });

  $("#id_altura").change(function() {
    atualizarPosicoesDivisor();
  });

  $("#id_abertura").change(function() {
    atualizarPosicoesDivisor();
  });

  $("input[name='btnradio']").change(function() {
    $("#qtd-divisor").val("");
    atualizarPosicoesDivisor();
  });

});
</script>

<script>
$(document).ready(function () {
  $('#id_quantidade, #id_largura, #id_altura, #id_acabamento, #id_perfil, #id_perfilpuxador, #id_puxador, #id_divisor, #id_vidro').change(function () {
    atualizarStringPorta();
  });

  $('input[name="btnradio"]').change(function () {
    atualizarStringPorta();
  });

  function atualizarStringPorta() {
    var tipoPorta = $('input[name="btnradio"]:checked').val();
    var quantidade = $('#id_quantidade').val() || '';
    var largura = $('#id_largura').val() || '';
    var altura = $('#id_altura').val() || '';
    var acabamentoDescricao = $('#id_acabamento option:selected').text() || '';
    var perfilModelo = $('#id_perfil option:selected').data('item')?.modelo ?? '';
    var perfilPuxadorModelo = $('#id_perfilpuxador option:selected').data('item')?.modelo ?? '';
    var puxadorModelo = $('#id_puxador option:selected').data('item')?.modelo ?? '';
    var divisorModelo = $('#id_divisor option:selected').data('item')?.modelo ?? '';
    var vidroModelo = $('#id_vidro option:selected').data('item')?.modelo ?? '';

    // Construa a string com os separadores condicionalmente
    var stringPorta = '';
    var stringQtd = '';

    if (tipoPorta === 'PortaGiro' || tipoPorta === 'PortaCorrer') {
        if ($('#id_largura').val() && $('#id_altura').val() && $('#id_quantidade').val() && $('#id_acabamento').val() && $('#id_perfil').val()) {
            stringQtd = (quantidade);
            stringPorta =
                ((acabamentoDescricao || perfilModelo) ? 'Porta ' : '') +
                (acabamentoDescricao ? acabamentoDescricao + ' ' : '') +
                ((acabamentoDescricao && perfilModelo) ? ' ' : '') +
                (perfilModelo ? perfilModelo + '' : '') +
                (perfilModelo && (perfilPuxadorModelo || puxadorModelo || divisorModelo) ? '/' : '') +
                (perfilPuxadorModelo ? perfilPuxadorModelo + '' : '') +
                (perfilPuxadorModelo && (puxadorModelo || divisorModelo) ? '/' : '') +
                (puxadorModelo ? puxadorModelo + '' : '') +
                (puxadorModelo && divisorModelo ? '/' : '') +
                (divisorModelo ? divisorModelo + ' ' : '') +
                ((largura || altura) ? ' ' : '') +
                ((largura && altura) ? largura + 'x' + altura + 'mm ' : '') +
                (vidroModelo ? vidroModelo + ' ' : '');
        }
    } else if (tipoPorta === 'Vidros') {
        if ($('#id_largura').val() && $('#id_altura').val() && $('#id_quantidade').val()) {
            stringQtd = (quantidade);
            stringPorta =
                ((largura || altura) ? 'Vidro ' : '') +
                ((largura && altura) ? ' ' : '') +
                ((largura && altura) ? largura + 'x' + altura + 'mm ' : '') +
                (vidroModelo ? ' ' + vidroModelo + ' ' : '');
        }
    }

    // Atualiza a <div> com a string gerada
    $('#qtditens').text(stringQtd);
    $('#nomeporta').text(stringPorta);
}

  // Chama a função inicialmente
  atualizarStringPorta();
});
</script>

<script>
    var svg = document.getElementById("meuSVG");

    // Valores fixos
    var comp1 = 150;
    var comp2 = 250;
    var larg = 11;
    var xp = 0;
    var xd = -40;
    var yp = 0;
    var yd = yp + 43.55;
    var larg_div = 4.3;
    var larg_perf = 4.7;
    var larg_pux = 3.17;
    var larg_tr = 2.75;
    var tr1 = 39.45
    var tr2 = tr1 / 2;//19.72
    var tr3 = 10.41;

    var x1 = xp + larg; //14.1
    var x2 = comp1 + xp; //152.7
    var x3 = x2 - larg; //141.7
    var x4 = xd + larg; //14.1
    var x5 = xd + comp2; //239.8
    var x6 = x5 - larg; //228.8

    var y1 = yp + larg; //68
    var y2 = yp + comp2; //293.7
    var y3 = y2 - larg; //282.7
    var y4 = yd + larg; //111.55
    var y5 = yd + comp1; //250.15
    var y6 = y5 - larg; //239.15
    var y7 = x6 - x4;//214.7
    var y8 = (y7 - larg_div) / 2;//105.2
    var y9 = (y7 - (larg_div * 2)) / 3//68.7
    var y10 = (y9 * 2) + larg_div + y1//209.7
    var y11 = xd + larg_div + (y9 * 2);//102.10
    var y13 = y2+larg_perf+larg_pux;//301.57
    var y14 = yp-larg_perf-larg_pux;//49.13
    var y15 = yd-larg_perf-larg_pux;//92.68
    var y16 = y5+larg_perf+larg_pux;//258.02


    // Pontos originais
    var pontosOriginais = {
      "perfil_esquerda": `${xp},${yp} ${xp},${y2} ${x1},${y3} ${x1},${y1}`,
      "perfil_inferior": `${x1},${y3} ${xp},${y2} ${x2},${y2} ${x3},${y3}`,
      "perfil_direita": `${x3},${y1} ${x3},${y3} ${x2},${y2} ${x2},${yp}`,
      "perfil_superior": `${xp},${yp} ${x1},${y1} ${x3},${y1} ${x2},${yp}`,
      "Divisor-A": `${x1},${(y1+y9)} ${x1},${(y1+y9+larg_div)} ${x3},${(y1+y9+larg_div)} ${x3},${(y1+y9)}`,
      "Divisor-B": `${x1},${(y1+y8)} ${x1},${(y1+y8+larg_div)} ${x3},${(y1+y8+larg_div)} ${x3},${(y1+y8)}`,
      "Divisor-C": `${x1},${y10} ${x1},${(y10 + larg_div)} ${x3},${(y10 + larg_div)} ${x3},${y10}`,
      "Vidro": `${x1},${y1} ${x1},${y3} ${x3},${y3} ${x3},${y1}`,
      "Vidro1_2": `${x1},${y1} ${x1},${(y1+y8)} ${x3},${(y1+y8)} ${x3},${y1}`,
      "Vidro2_2": `${x1},${(y1+y8+larg_div)} ${x1},${y3} ${x3},${y3} ${x3},${(y1+y8+larg_div)}`,
      "Vidro1_3": `${x1},${y1} ${x1},${(y1+y9)} ${x3},${(y1+y9)} ${x3},${y1}`,
      "Vidro2_3": `${x1},${(y1+y9+larg_div)} ${x1},${y10} ${x3},${y10} ${x3},${(y1+y9+larg_div)}`,
      "Vidro3_3": `${x1},${(y10 + larg_div)} ${x1},${y3} ${x3},${y3} ${x3},${(y10 + larg_div)}`,
      "PerfilPux-Esquerda-Cava": `${(xp-larg_perf)},${yp} ${(xp-larg_perf)},${y2} ${xp},${y2} ${xp},${yp}`,
      "PerfilPux-Base-Cava": `${xp},${y2} ${xp},${(y2+larg_perf)} ${x2},${(y2+larg_perf)} ${x2},${y2}`,
      "PerfilPux-Direita-Cava": `${x2},${yp} ${x2},${y2} ${(x2+larg_perf)},${y2} ${(x2+larg_perf)},${yp}`,
      "PerfilPux-Topo-Cava": `${xp},${(yp-larg_perf)} ${xp},${yp} ${x2},${yp} ${x2},${(yp-larg_perf)}`,
      "PerfilPux-Esquerda-detalhe": `${(xp-larg_perf-larg_pux)},${yp} ${(xp-larg_perf-larg_pux)},${y2} ${(xp-larg_perf)},${y2} ${(xp-larg_perf)},${yp}`,
      "PerfilPux-Base-detalhe": `${xp},${(y2+larg_perf)} ${xp},${y13} ${x2},${y13} ${x2},${(y2+larg_perf)}`,
      "PerfilPux-Direita-detalhe": `${(x2+larg_perf)},${yp} ${(x2+larg_perf)},${y2} ${(x2+larg_perf+larg_pux)},${y2} ${(x2+larg_perf+larg_pux)},${yp}`,
      "PerfilPux-Topo-detalhe": `${xp},${y14} ${xp},${(yp-larg_perf)} ${x2},${(yp-larg_perf)} ${x2},${y14}`,
      "Puxador-Esquerda-int": `${xp},${yp} ${xp},${y2} ${xp+larg_tr},${y2} ${xp+larg_tr},${yp}`,
      "Puxador-Esquerda-trecho-1": `${xp},${yp} ${xp},${(yp+tr1)} ${xp+larg_tr},${(yp+tr1)} ${xp+larg_tr},${yp}`,
      "Puxador-Esquerda-trecho-2": `${xp},${yp+(tr2*5)} ${xp},${yp+(tr2*7)} ${xp+larg_tr},${yp+(tr2*7)} ${xp+larg_tr},${yp+(tr2*5)}`,
      "Puxador-Esquerda-trecho-3": `${xp},${yp+(tr1*5)} ${xp},${yp+(tr1*6)} ${xp+larg_tr},${yp+(tr1*6)} ${xp+larg_tr},${yp+(tr1*5)}`,
      "Puxador-Base-int": `${xp},${(y2-larg_tr)} ${xp},${y2} ${x2},${y2} ${x2},${(y2-larg_tr)}`,
      "Puxador-Base-trecho-1": `${xp},${(y2-larg_tr)} ${xp},${y2} ${xp+tr1},${y2} ${xp+tr1},${(y2-larg_tr)}`,
      "Puxador-Base-trecho-2": `${xp+tr1+tr3},${(y2-larg_tr)} ${xp+tr1+tr3},${y2} ${xp+(tr1*2)+(tr3*2)},${y2} ${xp+(tr1*2)+(tr3*2)},${(y2-larg_tr)}`,
      "Puxador-Base-trecho-3": `${x2-tr1},${(y2-larg_tr)} ${x2-tr1},${y2} ${x2},${y2} ${x2},${(y2-larg_tr)}`,
      "Puxador-Direita-int": `${x2-larg_tr},${yp} ${x2-larg_tr},${y2} ${x2},${y2} ${x2},${yp}`,
      "Puxador-Direita-trecho-1": `${x2-larg_tr},${yp} ${x2-larg_tr},${(yp+tr1)} ${x2},${(yp+tr1)} ${x2},${yp}`,
      "Puxador-Direita-trecho-2": `${x2-larg_tr},${yp+(tr2*5)} ${x2-larg_tr},${yp+(tr2*7)} ${x2},${yp+(tr2*7)} ${x2},${yp+(tr2*5)}`,
      "Puxador-Direita-trecho-3": `${x2-larg_tr},${yp+(tr1*5)} ${x2-larg_tr},${yp+(tr1*6)} ${x2},${yp+(tr1*6)} ${x2},${yp+(tr1*5)}`,
      "Puxador-Topo-int": `${xp},${yp} ${xp},${yp+larg_tr} ${x2},${yp+larg_tr} ${x2},${yp}`,
      "Puxador-Topo-trecho-1": `${xp},${yp} ${xp},${yp+larg_tr} ${xp+tr1},${yp+larg_tr} ${xp+tr1},${yp}`,
      "Puxador-Topo-trecho-2": `${xp+tr1+tr3},${yp} ${xp+tr1+tr3},${yp+larg_tr} ${xp+(tr1*2)+(tr3*2)},${yp+larg_tr} ${xp+(tr1*2)+(tr3*2)},${yp}`,
      "Puxador-Topo-trecho-3": `${x2-tr1},${yp} ${x2-tr1},${yp+larg_tr} ${x2},${yp+larg_tr} ${x2},${yp}`,
      "medida-largura": `${(xp-larg_perf-larg_pux)},${(y13+32.63)} ${(xp-larg_perf-larg_pux)},${(y13+47.43)} ${(xp-larg_perf-larg_pux+1.7)},${(y13+47.43)} ${(xp-larg_perf-larg_pux+1.7)},${y13+41.33}
      ${((x2+larg_perf+larg_pux)-1.7)},${y13+41.33} ${((x2+larg_perf+larg_pux)-1.7)},${(y13+47.43)} ${(x2+larg_perf+larg_pux)},${y13+47.43} ${(x2+larg_perf+larg_pux)},${y13+32.63} ${((x2+larg_perf+larg_pux)-1.7)},${y13+32.63} ${((x2+larg_perf+larg_pux)-1.7)},${y13+38.73} ${(xp-larg_perf-larg_pux+1.7)},${y13+38.73} ${(xp-larg_perf-larg_pux+1.7)},${y13+32.63}`,
      "medida-altura": `${(x2+larg_perf+larg_pux+32.63)},${y14} ${(x2+larg_perf+larg_pux+32.63)},${(y14+1.7)} ${(x2+larg_perf+larg_pux+38.73)},${(y14+1.7)} ${(x2+larg_perf+larg_pux+38.73)},${(y13-1.7)}
      ${(x2+larg_perf+larg_pux+32.63)},${y13-1.7} ${(x2+larg_perf+larg_pux+32.63)},${(y13)} ${(x2+larg_perf+larg_pux+47.43)},${y13} ${(x2+larg_perf+larg_pux+47.43)},${y13-1.7} ${(x2+larg_perf+larg_pux+41.33)},${y13-1.7} ${(x2+larg_perf+larg_pux+41.33)},${(y14+1.7)} ${(x2+larg_perf+larg_pux+47.43)},${(y14+1.7)} ${(x2+larg_perf+larg_pux+47.43)},${y14}`
    };

    // Pontos transformados
    var pontosTransformados = {
      "perfil_esquerda": `${xd},${yd} ${xd},${y5} ${x4},${y6} ${x4},${y4}`,
      "perfil_inferior": `${x4},${y6} ${xd},${y5} ${x5},${y5} ${x6},${y6}`,
      "perfil_direita": `${x6},${y4} ${x6},${y6} ${x5},${y5} ${x5},${yd}`,
      "perfil_superior": `${xd},${yd} ${x4},${y4} ${x6},${y4} ${x5},${yd}`,
      "Divisor-A": `${(x4+y9)},${y4} ${(x4+y9)},${y6} ${(x4+y9+larg_div)},${y6} ${(x4+y9+larg_div)},${y4}`,
      "Divisor-B": `${(x4 + y8)},${y4} ${(x4 + y8)},${y6} ${(x4 + y8 + larg_div)},${y6} ${(x4 + y8 + larg_div)},${y4}`,
      "Divisor-C": `${(x6 - y9  - larg_div)},${y4} ${(x6 - y9 - larg_div)},${y6} ${x6 - y9},${y6} ${x6 - y9},${y4}`,
      "Vidro": `${x4},${y4} ${x4},${y6} ${x6},${y6} ${x6},${y4}`,
      "Vidro1_2": `${x4},${y4} ${x4},${y6} ${(x4 + y8)},${y6} ${(x4 + y8)},${y4}`,
      "Vidro2_2": `${(x4 + y8 + larg_div)},${y4} ${(x4 + y8 + larg_div)},${y6} ${x6},${y6} ${x6},${y4}`,
      "Vidro1_3": `${x4},${y4} ${x4},${y6} ${(x4+y9)},${y6} ${(x4+y9)},${y4}`,
      "Vidro2_3": `${(x4+y9+larg_div)},${y4} ${(x4+y9+larg_div)},${y6} ${(x6-y9-larg_div)},${y6} ${(x6-y9-larg_div)},${y4}`,
      "Vidro3_3": `${x6 - y9},${y4} ${x6 - y9},${y6} ${x6},${y6} ${x6},${y4}`,
      "PerfilPux-Esquerda-Cava": `${(xd-larg_perf)},${yd} ${(xd-larg_perf)},${y5} ${xd},${y5} ${xd},${yd}`,
      "PerfilPux-Base-Cava": `${xd},${y5} ${xd},${(y5+larg_perf)} ${x5},${(y5+larg_perf)} ${x5},${y5}`,
      "PerfilPux-Direita-Cava": `${x5},${yd} ${x5},${y5} ${(x5+larg_perf)},${y5} ${(x5+larg_perf)},${yd}`,
      "PerfilPux-Topo-Cava": `${xd},${(yd-larg_perf)} ${xd},${yd} ${x5},${yd} ${x5},${(yd-larg_perf)}`,
      "PerfilPux-Esquerda-detalhe": `${(xd-larg_perf-larg_pux)},${yd} ${(xd-larg_perf-larg_pux)},${y5} ${(xd-larg_perf)},${y5} ${(xd-larg_perf)},${yd}`,
      "PerfilPux-Base-detalhe": `${xd},${(y5+larg_perf)} ${xd},${y16} ${x5},${y16} ${x5},${(y5+larg_perf)}`,
      "PerfilPux-Direita-detalhe": `${(x5+larg_perf)},${yd} ${(x5+larg_perf)},${y5} ${(x5+larg_perf+larg_pux)},${y5} ${(x5+larg_perf+larg_pux)},${yd}`,
      "PerfilPux-Topo-detalhe": `${xd},${y15} ${xd},${(yd-larg_perf)} ${x5},${(yd-larg_perf)} ${x5},${y15}`,
      "Puxador-Esquerda-int": `${xd},${yd} ${xd},${y5} ${xd+larg_tr},${y5} ${xd+larg_tr},${yd}`,
      "Puxador-Esquerda-trecho-1": `${xd},${yd} ${xd},${(yd+tr1)} ${xd+larg_tr},${(yd+tr1)} ${xd+larg_tr},${yd}`,
      "Puxador-Esquerda-trecho-2": `${xd},${yd+tr1+tr3} ${xd},${yd+(tr1*2)+(tr3*2)} ${xd+larg_tr},${yd+(tr1*2)+(tr3*2)} ${xd+larg_tr},${yd+tr1+tr3}`,
      "Puxador-Esquerda-trecho-3": `${xd},${y5-tr1} ${xd},${y5} ${xd+larg_tr},${y5} ${xd+larg_tr},${y5-tr1}`,
      "Puxador-Base-int": `${xd},${(y5-larg_tr)} ${xd},${y5} ${x5},${y5} ${x5},${(y5-larg_tr)}`,
      "Puxador-Base-trecho-1": `${xd},${(y5-larg_tr)} ${xd},${y5} ${xd+tr1},${y5} ${xd+tr1},${(y5-larg_tr)}`,
      "Puxador-Base-trecho-2": `${xd+(tr1*2)+tr2},${(y5-larg_tr)} ${xd+(tr1*2)+tr2},${y5} ${x5-(tr1*2)-tr2},${y5} ${x5-(tr1*2)-tr2},${(y5-larg_tr)}`,
      "Puxador-Base-trecho-3": `${x5-tr1},${(y5-larg_tr)} ${x5-tr1},${y5} ${x5},${y5} ${x5},${(y5-larg_tr)}`,
      "Puxador-Direita-int": `${x5-larg_tr},${yd} ${x5-larg_tr},${y5} ${x5},${y5} ${x5},${yd}`,
      "Puxador-Direita-trecho-1": `${x5-larg_tr},${yd} ${x5-larg_tr},${(yd+tr1)} ${x5},${(yd+tr1)} ${x5},${yd}`,
      "Puxador-Direita-trecho-2": `${x5-larg_tr},${yd+tr1+tr3} ${x5-larg_tr},${yd+(tr1*2)+(tr3*2)} ${x5},${yd+(tr1*2)+(tr3*2)} ${x5},${yd+tr1+tr3}`,
      "Puxador-Direita-trecho-3": `${x5-larg_tr},${y5-tr1} ${x5-larg_tr},${y5} ${x5},${y5} ${x5},${y5-tr1}`,
      "Puxador-Topo-int": `${xd},${yd} ${xd},${(yd+larg_tr)} ${x5},${(yd+larg_tr)} ${x5},${yd}`,
      "Puxador-Topo-trecho-1": `${xd},${yd} ${xd},${(yd+larg_tr)} ${xd+tr1},${(yd+larg_tr)} ${xd+tr1},${yd}`,
      "Puxador-Topo-trecho-2": `${xd+(tr1*2)+tr2},${yd} ${xd+(tr1*2)+tr2},${(yd+larg_tr)} ${x5-(tr1*2)-tr2},${(yd+larg_tr)} ${x5-(tr1*2)-tr2},${yd}`,
      "Puxador-Topo-trecho-3": `${x5-tr1},${yd} ${x5-tr1},${(yd+larg_tr)} ${x5},${(yd+larg_tr)} ${x5},${yd}`,
      "medida-largura": `${(xd-larg_perf-larg_pux)},${(y16+32.63)} ${(xd-larg_perf-larg_pux)},${(y16+47.43)} ${(xd-larg_perf-larg_pux+1.7)},${(y16+47.43)} ${(xd-larg_perf-larg_pux+1.7)},${y16+41.33}
      ${((x5+larg_perf+larg_pux)-1.7)},${(y16+41.33)} ${((x5+larg_perf+larg_pux)-1.7)},${(y16+47.43)} ${(x5+larg_perf+larg_pux)},${y16+47.43} ${(x5+larg_perf+larg_pux)},${y16+32.63} ${((x5+larg_perf+larg_pux)-1.7)},${y16+32.63} ${((x5+larg_perf+larg_pux)-1.7)},${y16+38.73} ${(xd-larg_perf-larg_pux+1.7)},${y16+38.73} ${(xd-larg_perf-larg_pux+1.7)},${y16+32.63}`,
      "medida-altura": `${((x5+larg_perf)+larg_perf+larg_pux+32.63)},${y15} ${((x5+larg_perf)+larg_perf+larg_pux+32.63)},${(y15+1.7)} ${((x5+larg_perf)+larg_perf+larg_pux+38.73)},${(y15+1.7)} ${((x5+larg_perf)+larg_perf+larg_pux+38.73)},${(y16-1.7)}
      ${((x5+larg_perf)+larg_perf+larg_pux+32.63)},${y16-1.7} ${((x5+larg_perf)+larg_perf+larg_pux+32.63)},${(y16)} ${((x5+larg_perf)+larg_perf+larg_pux+47.43)},${y16} ${((x5+larg_perf)+larg_perf+larg_pux+47.43)},${y16-1.7} ${((x5+larg_perf)+larg_perf+larg_pux+41.33)},${y16-1.7} ${((x5+larg_perf)+larg_perf+larg_pux+41.33)},${(y15+1.7)} ${((x5+larg_perf)+larg_perf+larg_pux+47.43)},${(y15+1.7)} ${((x5+larg_perf)+larg_perf+larg_pux+47.43)},${y15}`
    };

   // Define as posições originais e transformadas dos textos
    var posicoesOriginaisTexto = {
      "Puxador-Esquerda-Tam": `matrix(4.489659e-11 -1 1 4.489659e-11 ${xp-11.1} ${yp+143})`,
      "Puxador-Base-Tam": `matrix(1 0 0 1 ${xp+50.9} ${yp+258})`,
      "Puxador-Direita-Tam": `matrix(-1.346898e-10 1 -1 -1.346898e-10 ${xp+160.5} ${yp+93})`,
      "Puxador-Topo-Tam": `matrix(1 0 0 1 ${xp+48.9} ${yp-11})`,
      "texto-largura": `matrix(1 0 0 1 ${xp+56.9} ${yp+299})`,
      "texto-altura": `matrix(-1.346898e-10 1 -1 -1.346898e-10 ${xp+201.9} ${yp+101})`
    };

    var posicoesTransformadasTexto = {
      "Puxador-Esquerda-Tam": `matrix(4.489659e-11 -1 1 4.489659e-11 ${xd-11.1} ${yd+99.45})`,
      "Puxador-Base-Tam": `matrix(1 0 0 1 ${xd+94} ${yd+170.45})`,
      "Puxador-Direita-Tam": `matrix(-1.346898e-10 1 -1 -1.346898e-10 ${xd+248} ${yd+49.45})`,
      "Puxador-Topo-Tam": `matrix(1 0 0 1 ${xd+92} ${yd-10.55})`,
      "texto-largura": `matrix(1 0 0 1 ${xd+100} ${yd+211.45})`,
      "texto-altura": `matrix(-1.346898e-10 1 -1 -1.346898e-10 ${xd+293} ${yd+57.45})`
    };

    var posicoesAtuaisTexto = posicoesOriginaisTexto; // Inicia com as posições originais

    var pontosAtuais = pontosOriginais;



    function alterarPontos() {
    	var largura = parseFloat($('#id_largura').val());
    	var altura = parseFloat($('#id_altura').val());

      // Determine se a largura é maior que a altura
    	var maiorLargura = largura > altura;
      var pontos = maiorLargura ? pontosTransformados : pontosOriginais;

      for (var id in pontos) {
        anime({
          targets: '#' + id,
          points: pontos[id],
          easing: 'easeInOutCubic',
          duration: 1500
        });
      }

      // Mostra a barra de medidas caso tenha valores nos campos
      var medidaDesenho = document.getElementById('MedidaDesenho');
      if (!isNaN(largura) && !isNaN(altura)) {
          medidaDesenho.classList.remove('st2');
          medidaDesenho.classList.add('st6');
      } else {
          medidaDesenho.classList.remove('st6');
          medidaDesenho.classList.add('st2');
      }
    }

    function alterarPosicoesTexto() {
      var largura = parseFloat($('#id_largura').val());
      var altura = parseFloat($('#id_altura').val());
      var maiorLargura = largura > altura;

      // Atualiza os valores dos textos de largura e altura
      document.getElementById('texto-largura').textContent = largura + "mm";
      document.getElementById('texto-altura').textContent = altura + "mm";

      // Use as posições originais ou transformadas com base na largura e altura
      var posicoesTexto = maiorLargura ? posicoesTransformadasTexto : posicoesOriginaisTexto;

      // Animações para os textos
      for (var idTexto in posicoesTexto) {
        anime({
          targets: '#' + idTexto,
          transform: [
            { value: posicoesTexto[idTexto] }
          ],
          easing: 'easeInOutCubic',
          duration: 1500
        });
      }
    }
    // Adicione um manipulador de evento de clique a cada polygon dentro de Puxador-Topo-trecho
    function alterarCorPuxadores(idGrupo) {
      var grupo = document.getElementById(idGrupo);

      // Encontre o polígono clicado dentro do grupo
      var target = event.target;
      if (target.tagName === 'polygon') {
        var isRed = target.getAttribute('fill') === '#ff0000';

        // Remova a cor vermelha de todos os polígonos dentro do grupo
        var poligonos = grupo.getElementsByTagName('polygon');
        for (var i = 0; i < poligonos.length; i++) {
          poligonos[i].classList.add('st2'); // Adiciona a classe st2 para ocultá-los
        }

        // Se o polígono clicado já estiver vermelho, volte todos os outros polígonos para preto
        if (isRed) {
          // Restaure a cor preta de todos os polígonos dentro do grupo
          for (var i = 0; i < poligonos.length; i++) {
            poligonos[i].classList.remove('st2');
            poligonos[i].setAttribute('fill', '#000000'); // volta a cor preta
          }
        } else {
          // Altere a cor do polígono clicado para vermelho
          target.setAttribute('fill', '#ff0000');
          target.classList.remove('st2');
        }
      }
    }
$(document).ready(function() {
  $('#id_largura, #id_altura').on('blur', function() {
    alterarPontos();
    alterarPosicoesTexto();
  });
});
</script>

<script>
$(document).ready(function() {
  // Adiciona um ouvinte de evento para quando houver mudança no campo id_puxador
  $('#id_puxador').on('change', function() {
    var idPuxador = $(this).val();
    if (idPuxador === '') {
      $('.Puxador-Esquerda, .Puxador-Base, .Puxador-Direita, .Puxador-Topo').removeClass('st6');
    }
  });
});
</script>

<script>
function alterarVidro() {
    var campovidro = $("#id_vidro").val();
    var desenhovidro = $("#Vidro");

    if (campovidro !== "") {
        desenhovidro.removeClass("st2");
    } else {
        desenhovidro.addClass("st2");
    }

    var qtdDivisor = parseInt($("#qtd-divisor").val());

    // Verificar para Vidro1_2
    var idVidro1 = $("#id_vidro1").val();
    var vidro1_2 = $("#Vidro1_2");

    if (qtdDivisor === 1 && idVidro1 !== "") {
        vidro1_2.removeClass("st2");
    } else {
        vidro1_2.addClass("st2");
    }

    // Verificar para Vidro2_2
    var idVidro2 = $("#id_vidro2").val();
    var vidro2_2 = $("#Vidro2_2");

    if (qtdDivisor === 1 && idVidro2 !== "") {
        vidro2_2.removeClass("st2");
    } else {
        vidro2_2.addClass("st2");
    }

    // Verificar para Vidro1_3
    var idVidro1 = $("#id_vidro1").val();
    var vidro1_3 = $("#Vidro1_3");

    if (qtdDivisor === 2 && idVidro1 !== "") {
        vidro1_3.removeClass("st2");
    } else {
        vidro1_3.addClass("st2");
    }

    // Verificar para Vidro2_3
    var idVidro2 = $("#id_vidro2").val();
    var vidro2_3 = $("#Vidro2_3");

    if (qtdDivisor === 2 && idVidro2 !== "") {
        vidro2_3.removeClass("st2");
    } else {
        vidro2_3.addClass("st2");
    }

    // Verificar para Vidro3_3
    var idVidro3 = $("#id_vidro3").val();
    var vidro3_3 = $("#Vidro3_3");

    if (qtdDivisor === 2 && idVidro3 !== "") {
        vidro3_3.removeClass("st2");
    } else {
        vidro3_3.addClass("st2");
    }
}

$(document).ready(function() {
    // Manipulador de evento para mudanças em #id_vidro
    $("#id_quantidade, #id_largura, #id_altura, #id_acabamento, #id_abertura, #id_perfil, #id_perfilpuxador, #id_puxador").change(function() {
        alterarVidro();
    });

    // Manipulador de evento para mudanças em #id_vidro
    $("#id_vidro, #id_vidro1, #id_vidro2, #id_vidro3").change(function() {
        alterarVidro();
    });

    // Manipulador de evento para mudanças em #id_divisor
    $("#id_divisor, #qtd-divisor").change(function() {
        $("#id_vidro, #id_vidro1, #id_vidro2, #id_vidro3").val("");
        alterarVidro();
    });

});
</script>

<script>

function calcularPrecoPerfil() {

    // Verificar se o campo do perfil puxador está vazio
    if ($('#id_perfilpuxador').val() === '') {
        perfilpuxadorusado = 0; // Zerar a variável perfilpuxadorusado
    }

    // Verificar se o campo do puxador está vazio
    if ($('#id_puxador').val() === '') {
        puxadorusado = 0; // Zerar a variável puxadorusado
    }

    // Verificar se o campo do divisor está vazio
    if ($('#id_divisor').val() === '') {
        divisorusado = 0; // Zerar a variável divisorusado
    }

    // Verificar se o campo do vidro está vazio
    if ($('#id_vidro').val() === '') {
        vidrousado = 0; // Zerar a variável vidrousado
    }

    // Verificar se o campo do vidro1 está vazio
    if ($('#id_vidro1').val() === '') {
        vidrousado1 = 0; // Zerar a variável vidrousado1
    }

    // Verificar se o campo do vidro2 está vazio
    if ($('#id_vidro2').val() === '') {
        vidrousado2 = 0; // Zerar a variável vidrousado2
    }

    // Verificar se o campo do vidro3 está vazio
    if ($('#id_vidro3').val() === '') {
        vidrousado3 = 0; // Zerar a variável vidrousado3
    }

    var quantidade = parseFloat($('#id_quantidade').val());
    var largura = parseFloat($('#id_largura').val()) / 1000;
    var altura = parseFloat($('#id_altura').val()) / 1000;

    var perfilPreco = parseFloat($('#id_perfil option:selected').data('item')?.preco || 0);
    var perfiltamanho = parseFloat($('#id_perfil option:selected').data('item')?.largura_perfil || 0);

    var perfilPuxadorPreco = parseFloat($('#id_perfilpuxador option:selected').data('item')?.preco || 0);
    var posicaoPerfilPuxador = $('#posicao-perfilpuxador').val() || '';

    var posicaoPuxador = $('#posicao-puxador').val() || '';
    var puxadorPreco = parseFloat($('#id_puxador option:selected').data('item')?.preco || 0);
    var qtdPuxador = $('#qtd-puxador').val() || '';
    var tamPuxador = parseFloat($('#tam-puxador').val()) / 1000;

    var divisorPreco = parseFloat($('#id_divisor option:selected').data('item')?.preco || 0);
    var qtdDivisor = $('#qtd-divisor').val() || '';

    var vidroPreco = parseFloat($('#id_vidro option:selected').data('preco') || 0);
    var vidro1Preco = parseFloat($('#id_vidro1 option:selected').data('preco') || 0);
    var vidro2Preco = parseFloat($('#id_vidro2 option:selected').data('preco') || 0);
    var vidro3Preco = parseFloat($('#id_vidro3 option:selected').data('preco') || 0);

    var precoPerfilFinal = 0;
    var precoPerfilPuxadorFinal  = 0;
    var precoPuxadorFinal  = 0;
    var precoDivisorFinal = 0;
    var precoVidroFinal = 0;
    var precoVidroFinal1 = 0;
    var precoVidroFinal2 = 0;
    var precoVidroFinal3 = 0;


    if ($('#id_perfil').val() !== '') {
        if ($('#id_perfilpuxador').val() === '' && $('#id_puxador').val() === '') {
            precoPerfilFinal = ((largura * 2) + (altura * 2)) * perfilPreco;
            perfilusado = ((largura * 2) + (altura * 2));
            if ($('#qtd-divisor').val() === null || $('#qtd-divisor').val() === undefined || $('#qtd-divisor').val() === '') {
                if ($('#id_vidro').val()) {
                    precoVidroFinal = (largura * altura) * vidroPreco;
                    vidrousado = (largura * altura);
                }
            } else if ($('#qtd-divisor').val() === '1') {
                precoDivisorFinal = (largura * divisorPreco);
                divisorusado = largura;
                if ($('#id_vidro1').val() && $('#id_vidro2').val()) {
                    precoVidroFinal1 = (largura * (altura / 2)) * vidro1Preco;
                    precoVidroFinal2 = (largura * (altura / 2)) * vidro2Preco;
                    vidrousado1 = (largura * (altura / 2));
                    vidrousado2 = (largura * (altura / 2));
                }
            } else if ($('#qtd-divisor').val() === '2') {
                precoDivisorFinal = ((largura * divisorPreco) * 2);
                divisorusado = (largura * 2);
                if ($('#id_vidro1').val() && $('#id_vidro2').val() && $('#id_vidro3').val()) {
                    precoVidroFinal1 = (largura * (altura / 3)) * vidro1Preco;
                    precoVidroFinal2 = (largura * (altura / 3)) * vidro2Preco;
                    precoVidroFinal3 = (largura * (altura / 3)) * vidro3Preco;
                    vidrousado1 = (largura * (altura / 3));
                    vidrousado2 = (largura * (altura / 3));
                    vidrousado3 = (largura * (altura / 3));
                }
            }
        } else if (posicaoPerfilPuxador === 'Base' || posicaoPerfilPuxador === 'Topo') {
            precoPerfilFinal  = (largura * perfilPreco) + ((altura * 2) * perfilPreco);
            precoPerfilPuxadorFinal  = largura * perfilPuxadorPreco;
            perfilusado  = largura + (altura * 2);
            perfilpuxadorusado  = largura;
            if ($('#qtd-divisor').val() === null || $('#qtd-divisor').val() === undefined || $('#qtd-divisor').val() === '') {
                if ($('#id_vidro').val()) {
                    precoVidroFinal = (largura * altura) * vidroPreco;
                    vidrousado = (largura * altura);
                }
            } else if ($('#qtd-divisor').val() === '1') {
                precoDivisorFinal = (largura * divisorPreco);
                divisorusado = largura;
                if ($('#id_vidro1').val() && $('#id_vidro2').val()) {
                    precoVidroFinal1 = (largura * (altura / 2)) * vidro1Preco;
                    precoVidroFinal2 = (largura * (altura / 2)) * vidro2Preco;
                    vidrousado1 = (largura * (altura / 2));
                    vidrousado2 = (largura * (altura / 2));
                }
            } else if ($('#qtd-divisor').val() === '2') {
                precoDivisorFinal = ((largura * divisorPreco) * 2);
                divisorusado = (largura * 2);
                if ($('#id_vidro1').val() && $('#id_vidro2').val() && $('#id_vidro3').val()) {
                    precoVidroFinal1 = (largura * (altura / 3)) * vidro1Preco;
                    precoVidroFinal2 = (largura * (altura / 3)) * vidro2Preco;
                    precoVidroFinal3 = (largura * (altura / 3)) * vidro3Preco;
                    vidrousado1 = (largura * (altura / 3));
                    vidrousado2 = (largura * (altura / 3));
                    vidrousado3 = (largura * (altura / 3));
                }
            }
        } else if (posicaoPerfilPuxador === 'Direita' || posicaoPerfilPuxador === 'Esquerda') {
            precoPerfilFinal  = ((largura * 2) * perfilPreco) + (altura * perfilPreco);
            precoPerfilPuxadorFinal  = altura * perfilPuxadorPreco;
            perfilusado  = (largura * 2) + altura;
            perfilpuxadorusado  = altura;
            if ($('#qtd-divisor').val() === null || $('#qtd-divisor').val() === undefined || $('#qtd-divisor').val() === '') {
                if ($('#id_vidro').val()) {
                    precoVidroFinal = (largura * altura) * vidroPreco;
                    vidrousado = (largura * altura);
                }
            } else if ($('#qtd-divisor').val() === '1') {
                precoDivisorFinal = (largura * divisorPreco);
                divisorusado = largura;
                if ($('#id_vidro1').val() && $('#id_vidro2').val()) {
                    precoVidroFinal1 = (largura * (altura / 2)) * vidro1Preco;
                    precoVidroFinal2 = (largura * (altura / 2)) * vidro2Preco;
                    vidrousado1 = (largura * (altura / 2));
                    vidrousado2 = (largura * (altura / 2));
                }
            } else if ($('#qtd-divisor').val() === '2') {
                precoDivisorFinal = ((largura * divisorPreco) * 2);
                divisorusado = (largura * 2);
                if ($('#id_vidro1').val() && $('#id_vidro2').val() && $('#id_vidro3').val()) {
                    precoVidroFinal1 = (largura * (altura / 3)) * vidro1Preco;
                    precoVidroFinal2 = (largura * (altura / 3)) * vidro2Preco;
                    precoVidroFinal3 = (largura * (altura / 3)) * vidro3Preco;
                    vidrousado1 = (largura * (altura / 3));
                    vidrousado2 = (largura * (altura / 3));
                    vidrousado3 = (largura * (altura / 3));
                }
            }
        } else if (posicaoPerfilPuxador === 'Esq/Dir') {
            precoPerfilFinal  = (largura * 2) * perfilPreco;
            precoPerfilPuxadorFinal  = (altura * 2) * perfilPuxadorPreco;
            perfilusado  = largura * 2;
            perfilpuxadorusado  = altura * 2
            if ($('#qtd-divisor').val() === null || $('#qtd-divisor').val() === undefined || $('#qtd-divisor').val() === '') {
                if ($('#id_vidro').val()) {
                    precoVidroFinal = (largura * altura) * vidroPreco;
                    vidrousado = (largura * altura);
                }
            } else if ($('#qtd-divisor').val() === '1') {
                precoDivisorFinal = (largura * divisorPreco);
                divisorusado = largura;
                if ($('#id_vidro1').val() && $('#id_vidro2').val()) {
                    precoVidroFinal1 = (largura * (altura / 2)) * vidro1Preco;
                    precoVidroFinal2 = (largura * (altura / 2)) * vidro2Preco;
                    vidrousado1 = (largura * (altura / 2));
                    vidrousado2 = (largura * (altura / 2));
                }
            } else if ($('#qtd-divisor').val() === '2') {
                precoDivisorFinal = ((largura * divisorPreco) * 2);
                divisorusado = (largura * 2);
                if ($('#id_vidro1').val() && $('#id_vidro2').val() && $('#id_vidro3').val()) {
                    precoVidroFinal1 = (largura * (altura / 3)) * vidro1Preco;
                    precoVidroFinal2 = (largura * (altura / 3)) * vidro2Preco;
                    precoVidroFinal3 = (largura * (altura / 3)) * vidro3Preco;
                    vidrousado1 = (largura * (altura / 3));
                    vidrousado2 = (largura * (altura / 3));
                    vidrousado3 = (largura * (altura / 3));
                }
            }
        } else if ($('#qtd-puxador').val() === '1' && ($('#tam-puxador').val())) {
            precoPerfilFinal  = ((largura * 2) + (altura * 2)) * perfilPreco;
            precoPuxadorFinal  = tamPuxador * puxadorPreco;
            perfilusado  = (largura * 2) + (altura * 2);
            puxadorusado  = tamPuxador;
            console.log("Antes de acessar divisores")
            if ($('#qtd-divisor').val() === null || $('#qtd-divisor').val() === undefined || $('#qtd-divisor').val() === '') {
                if ($('#id_vidro').val()) {
                    console.log("passou por divisores")
                    precoVidroFinal = (largura * altura) * vidroPreco;
                    vidrousado = (largura * altura);
                }
            } else if ($('#qtd-divisor').val() === '1') {
                precoDivisorFinal = (largura * divisorPreco);
                divisorusado = largura;
                if ($('#id_vidro1').val() && $('#id_vidro2').val()) {
                    precoVidroFinal1 = (largura * (altura / 2)) * vidro1Preco;
                    precoVidroFinal2 = (largura * (altura / 2)) * vidro2Preco;
                    vidrousado1 = (largura * (altura / 2));
                    vidrousado2 = (largura * (altura / 2));
                }
            } else if ($('#qtd-divisor').val() === '2') {
                precoDivisorFinal = ((largura * divisorPreco) * 2);
                divisorusado = (largura * 2);
                if ($('#id_vidro1').val() && $('#id_vidro2').val() && $('#id_vidro3').val()) {
                    precoVidroFinal1 = (largura * (altura / 3)) * vidro1Preco;
                    precoVidroFinal2 = (largura * (altura / 3)) * vidro2Preco;
                    precoVidroFinal3 = (largura * (altura / 3)) * vidro3Preco;
                    vidrousado1 = (largura * (altura / 3));
                    vidrousado2 = (largura * (altura / 3));
                    vidrousado3 = (largura * (altura / 3));
                }
            }
        } else if ($('#qtd-puxador').val() === '2' && ($('#tam-puxador').val())) {
            precoPerfilFinal  = ((largura * 2) + (altura * 2)) * perfilPreco;
            precoPuxadorFinal  = 2 * (tamPuxador * puxadorPreco);
            perfilusado  = (largura * 2) + (altura * 2);
            puxadorusado  = 2 * (tamPuxador);
            console.log("Antes de acessar divisores")
            if ($('#qtd-divisor').val() === null || $('#qtd-divisor').val() === undefined || $('#qtd-divisor').val() === '') {
                if ($('#id_vidro').val()) {
                    console.log("passou por divisores")
                    precoVidroFinal = (largura * altura) * vidroPreco;
                    vidrousado = (largura * altura);
                }
            } else if ($('#qtd-divisor').val() === '1') {
                precoDivisorFinal = (largura * divisorPreco);
                divisorusado = largura;
                if ($('#id_vidro1').val() && $('#id_vidro2').val()) {
                    precoVidroFinal1 = (largura * (altura / 2)) * vidro1Preco;
                    precoVidroFinal2 = (largura * (altura / 2)) * vidro2Preco;
                    vidrousado1 = (largura * (altura / 2));
                    vidrousado2 = (largura * (altura / 2));
                }
            } else if ($('#qtd-divisor').val() === '2') {
                precoDivisorFinal = ((largura * divisorPreco) * 2);
                divisorusado = (largura * 2);
                if ($('#id_vidro1').val() && $('#id_vidro2').val() && $('#id_vidro3').val()) {
                    precoVidroFinal1 = (largura * (altura / 3)) * vidro1Preco;
                    precoVidroFinal2 = (largura * (altura / 3)) * vidro2Preco;
                    precoVidroFinal3 = (largura * (altura / 3)) * vidro3Preco;
                    vidrousado1 = (largura * (altura / 3));
                    vidrousado2 = (largura * (altura / 3));
                    vidrousado3 = (largura * (altura / 3));
                }
            }
        }
    }


    // Atualiza a label com id "valorperfil"
    $('#valorperfil').text(precoPerfilFinal.toFixed(2));
    $('#valorperfilpuxador').text(precoPerfilPuxadorFinal.toFixed(2));
    $('#valorpuxador').text(precoPuxadorFinal.toFixed(2));
    $('#valordivisor').text(precoDivisorFinal.toFixed(2));

    var somaTotal = ((precoPerfilFinal + precoPerfilPuxadorFinal + precoPuxadorFinal + precoDivisorFinal + precoVidroFinal + precoVidroFinal1 + precoVidroFinal2 + precoVidroFinal3) * quantidade);
    $('#valorporta').text(somaTotal.toFixed(2));


    console.log("Preço Perfil: " + precoPerfilFinal.toFixed(2));
    console.log("Preço PerfilPuxador: " + precoPerfilPuxadorFinal.toFixed(2));
    console.log("Preço Puxador: " + precoPuxadorFinal.toFixed(2));
    console.log("Preço Divisor: " + precoDivisorFinal.toFixed(2));
    console.log("Preço Vidro: " + precoVidroFinal.toFixed(2));
    console.log("Preço Vidro1: " + precoVidroFinal1.toFixed(2));
    console.log("Preço Vidro2: " + precoVidroFinal2.toFixed(2));
    console.log("Preço Vidro3: " + precoVidroFinal3.toFixed(2));

    console.log("Perfil Usado: " + perfilusado.toFixed(2));
    console.log("Perfil Puxador Usado: " + perfilpuxadorusado.toFixed(2));
    console.log("Puxador Usado: " + puxadorusado.toFixed(2));
    console.log("Divisor Usado: " + divisorusado.toFixed(2));
    console.log("Vidro Usado: " + vidrousado.toFixed(2));
    console.log("Vidro1 Usado: " + vidrousado1.toFixed(2));
    console.log("Vidro2 Usado: " + vidrousado2.toFixed(2));
    console.log("Vidro3 Usado: " + vidrousado3.toFixed(2));
}

// Chama a função quando os campos mudam
$('#id_largura, #id_altura, #id_perfil, #id_perfilpuxador, #qtd-perfilpuxador, #posicao-perfilpuxador, #id_puxador, #qtd-puxador, #posicao-puxador, #tam-puxador, #id_divisor, #qtd-divisor, #id_vidro, #id_vidro1, #id_vidro2, #id_vidro3').change(function() {
    calcularPrecoPerfil();
});

// Adiciona chamada de função quando a quantidade de perfil puxador for alterada
$('#qtd-perfilpuxador, #id_divisor').on('change', function() {
    setTimeout(function() {
        calcularPrecoPerfil();
    }, 100); // Aguarda 100ms para garantir que a alteração do valor seja totalmente processada
});

$(document).ready(function() {
  // Adicione um evento de escuta para mudanças nos campos de entrada
  $('#id_largura, #id_altura').on('input', function() {
    alterarPontos(); // Chama a função para atualizar os pontos do desenho
    alterarPosicoesTexto(); // Chama a função para atualizar as posições dos textos
  });
});
</script>

<script>

function calcularMaterial() {
    var largura = parseFloat($('#id_largura').val());
    var altura = parseFloat($('#id_altura').val());

    var perfilDescricao = $('#id_perfil option:selected').data('item')?.descricao ?? '';
    var perfilLarguraPerfil = parseFloat($('#id_perfil option:selected').data('item')?.largura_perfil || 0);
    var perfilAbaPerfil = parseFloat($('#id_perfil option:selected').data('item')?.aba_perfil || 0);
    var perfilDescontoVidro = parseFloat($('#id_perfil option:selected').data('item')?.desconto_vidro || 0);
    var perfilLarguraPuxador = parseFloat($('#id_perfil option:selected').data('item')?.largura_puxador || 0);

    var posicaoPerfilPuxador = $('#posicao-perfilpuxador').val() || '';
    var perfilPuxadorDescricao = $('#id_perfilpuxador option:selected').data('item')?.descricao ?? '';
    var perfilPuxadorLarguraPerfil = parseFloat($('#id_perfilpuxador option:selected').data('item')?.largura_perfil || 0);
    var perfilPuxadorAbaPerfil = parseFloat($('#id_perfilpuxador option:selected').data('item')?.aba_perfil || 0);
    var perfilPuxadorDescontoVidro = parseFloat($('#id_perfilpuxador option:selected').data('item')?.desconto_vidro || 0);
    var perfilPuxadorLarguraPuxador = parseFloat($('#id_perfilpuxador option:selected').data('item')?.largura_puxador || 0);

    var posicaoPuxador = $('#posicao-puxador').val() || '';
    var puxadorDescricao = $('#id_puxador option:selected').data('item')?.descricao ?? '';
    var tamPuxador = parseFloat($('#tam-puxador').val());
    var descontoPuxador = parseFloat($('#id_puxador option:selected').data('item')?.desconto_puxador || 0);

    var divisorDescricao = $('#id_divisor option:selected').data('descricao') || '';
    var espDivisor = parseFloat($('#id_divisor option:selected').data('espdivisor') || 0);
    var qtdDivisor = $('#qtd-divisor').val() || '';
    var tipoDivisor = $('#id_divisor option:selected').data('tipodivisor');

    var vidroDescricao = $('#id_vidro option:selected').data('descricao') || '';
<!--    console.dir($('#id_divisor option:selected').data());-->
    var vidro1Descricao = $('#id_vidro1 option:selected').data('descricao') || '';
    var vidro2Descricao = $('#id_vidro2 option:selected').data('descricao') || '';
    var vidro3Descricao = $('#id_vidro3 option:selected').data('descricao') || '';


    var perfilCorte = [];
    var perfilPuxadorCorte = [];
    var puxadorCorte = [];
    var divisorCorte = [];
    var vidroCorte = [];
    var larguraVidro;
    var alturaVidro;
    var divisor;
    var extrusao;
    var larguraVidro1;
    var alturaVidro1;
    var larguraVidro2;
    var alturaVidro2;
    var larguraVidro3;
    var alturaVidro3;

    if ($('#id_perfilpuxador').val() === '' && $('#id_puxador').val() === '') {
        if ($('#qtd-divisor').val() === null || $('#qtd-divisor').val() === undefined || $('#qtd-divisor').val() === '') {
            perfilCorte.push("2x " + perfilDescricao + " " + largura + "mm");
            perfilCorte.push("2x " + perfilDescricao + " " + altura + "mm");
            if ($('#id_vidro').val()) {
                larguraVidro = largura - (perfilDescontoVidro * 2).toFixed(2);
                alturaVidro = altura - (perfilDescontoVidro * 2).toFixed(2);
                vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
            }
        } else if ($('#qtd-divisor').val() === '1') {
            perfilCorte.push("2x " + perfilDescricao + " " + largura + "mm");
            perfilCorte.push("2x " + perfilDescricao + " " + altura + "mm");
            if (tipoDivisor === "Aparente") {
                divisor = largura - (perfilAbaPerfil * 2).toFixed(2);
                extrusao = perfilLarguraPerfil - perfilAbaPerfil.toFixed(2);
                divisorCorte.push("1x " + divisorDescricao + " " + divisor + "mm ("+ extrusao + "mm)");
                if ($('#id_vidro1').val() && $('#id_vidro2').val()) {
                    larguraVidro1 = largura - (perfilDescontoVidro * 2).toFixed(2);
                    alturaVidro1 = ((altura - perfilDescontoVidro - espDivisor) / 2).toFixed(2);
                    larguraVidro2 = largura - (perfilDescontoVidro * 2).toFixed(2);
                    alturaVidro2 = ((altura - perfilDescontoVidro - espDivisor) / 2).toFixed(2);
                    vidroCorte.push("1x " + vidro1Descricao + " " + larguraVidro1 + "x" + alturaVidro1 + "mm");
                    vidroCorte.push("1x " + vidro2Descricao + " " + larguraVidro2 + "x" + alturaVidro2 + "mm");
                }
            } else if (tipoDivisor === "Oculto") {
                divisor = largura - (perfilLarguraPerfil * 2).toFixed(2);
                divisorCorte.push("1x " + divisorDescricao + " " + divisor + "mm");
                if ($('#id_vidro').val()) {
                    larguraVidro = largura - (perfilDescontoVidro * 2).toFixed(2);
                    alturaVidro = altura - (perfilDescontoVidro * 2).toFixed(2);
                    vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                }
            }
        } else if ($('#qtd-divisor').val() === '2') {
            perfilCorte.push("2x " + perfilDescricao + " " + largura + "mm");
            perfilCorte.push("2x " + perfilDescricao + " " + altura + "mm");
            if (tipoDivisor === "Aparente") {
                divisor = largura - (perfilAbaPerfil * 2).toFixed(2);
                extrusao = perfilLarguraPerfil - perfilAbaPerfil.toFixed(2);
                divisorCorte.push("2x " + divisorDescricao + " " + divisor + "mm ("+ extrusao + "mm)");
                if ($('#id_vidro1').val() && $('#id_vidro2').val() && $('#id_vidro3').val()) {
                    larguraVidro1 = (largura - (perfilDescontoVidro * 2)).toFixed(2);
                    alturaVidro1 = ((altura - perfilDescontoVidro - espDivisor) / 3).toFixed(2);
                    larguraVidro2 = (largura - (perfilDescontoVidro * 2)).toFixed(2);
                    alturaVidro2 = ((altura - perfilDescontoVidro - espDivisor) / 3).toFixed(2);
                    larguraVidro3 = (largura - (perfilDescontoVidro * 2)).toFixed(2);
                    alturaVidro3 = ((altura - perfilDescontoVidro - espDivisor) / 3).toFixed(2);
                    vidroCorte.push("1x " + vidro1Descricao + " " + larguraVidro1 + "x" + alturaVidro1 + "mm");
                    vidroCorte.push("1x " + vidro2Descricao + " " + larguraVidro2 + "x" + alturaVidro2 + "mm");
                    vidroCorte.push("1x " + vidro3Descricao + " " + larguraVidro3 + "x" + alturaVidro3 + "mm");
                }
            }
            if (tipoDivisor === "Oculto") {
                divisor = largura - (perfilLarguraPerfil * 2).toFixed(2);
                divisorCorte.push("2x" + divisorDescricao + " " + divisor + "mm");
                if ($('#id_vidro').val()) {
                    larguraVidro = largura - (perfilDescontoVidro * 2).toFixed(2);
                    alturaVidro = altura - (perfilDescontoVidro * 2).toFixed(2);
                    vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                }
            }
        }
    } else if ($('#posicao-perfilpuxador').val() === "Topo" || $('#posicao-perfilpuxador').val() === "Base") {
        if ($('#qtd-divisor').val() === null || $('#qtd-divisor').val() === undefined || $('#qtd-divisor').val() === '') {
            perfilCorte.push("1x " + perfilDescricao + " " + largura + "mm");
            perfilCorte.push("2x " + perfilDescricao + " " + (altura - perfilPuxadorLarguraPuxador) + "mm");
            perfilPuxadorCorte.push("1x " + perfilPuxadorDescricao + " " + largura + "mm");
            if ($('#id_vidro').val()) {
                larguraVidro = largura - (perfilDescontoVidro * 2).toFixed(2);
                alturaVidro = (altura - perfilDescontoVidro - perfilPuxadorDescontoVidro).toFixed(2);
                vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
            }
        } else if ($('#qtd-divisor').val() === '1') {
            perfilCorte.push("1x " + perfilDescricao + " " + largura + "mm");
            perfilCorte.push("2x " + perfilDescricao + " " + (altura - perfilPuxadorLarguraPuxador) + "mm");
            perfilPuxadorCorte.push("1x " + perfilPuxadorDescricao + " " + largura + "mm");
            if (tipoDivisor === "Aparente") {
                divisor = largura - (perfilAbaPerfil * 2);
                extrusao = perfilLarguraPerfil - perfilAbaPerfil.toFixed(2);
                divisorCorte.push("1x " + divisorDescricao + " " + divisor + "mm ("+ extrusao + "mm)");
                if ($('#id_vidro1').val() && $('#id_vidro2').val()) {
                    larguraVidro1 = largura - (perfilDescontoVidro * 2).toFixed(2);
                    alturaVidro1 = ((altura - perfilDescontoVidro - perfilPuxadorDescontoVidro - espDivisor) / 2).toFixed(2);
                    larguraVidro2 = largura - (perfilDescontoVidro * 2).toFixed(2);
                    alturaVidro2 = ((altura - perfilDescontoVidro - perfilPuxadorDescontoVidro - espDivisor) / 2).toFixed(2);
                    vidroCorte.push("1x " + vidro1Descricao + " " + larguraVidro1 + "x" + alturaVidro1 + "mm");
                    vidroCorte.push("1x " + vidro2Descricao + " " + larguraVidro2 + "x" + alturaVidro2 + "mm");
                }
            } else if (tipoDivisor === "Oculto") {
                divisor = largura - (perfilLarguraPerfil * 2);
                divisorCorte.push("1x " + divisorDescricao + " " + divisor + "mm");
                if ($('#id_vidro').val()) {
                        larguraVidro = largura - (perfilDescontoVidro * 2).toFixed(2);
                        alturaVidro = (altura - perfilDescontoVidro - perfilPuxadorDescontoVidro).toFixed(2);
                        vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                }
            }
        } else if ($('#qtd-divisor').val() === '2') {
            perfilCorte.push("1x " + perfilDescricao + " " + largura + "mm");
            perfilCorte.push("2x " + perfilDescricao + " " + (altura - perfilPuxadorLarguraPuxador) + "mm");
            perfilPuxadorCorte.push("1x " + perfilPuxadorDescricao + " " + largura + "mm");
            if (tipoDivisor === "Aparente") {
                divisor = largura - (perfilAbaPerfil * 2).toFixed(2);
                extrusao = perfilLarguraPerfil - perfilAbaPerfil.toFixed(2);
                divisorCorte.push("2x " + divisorDescricao + " " + divisor + "mm ("+ extrusao + "mm)");
                if ($('#id_vidro1').val() && $('#id_vidro2').val() && $('#id_vidro3').val()) {
                    larguraVidro1 = largura - (perfilDescontoVidro * 2).toFixed(2);
                    alturaVidro1 = ((altura - perfilDescontoVidro - perfilPuxadorDescontoVidro - espDivisor) / 3).toFixed(2);
                    larguraVidro2 = largura - (perfilDescontoVidro * 2).toFixed(2);
                    alturaVidro2 = ((altura - perfilDescontoVidro - perfilPuxadorDescontoVidro - espDivisor) / 3).toFixed(2);
                    larguraVidro3 = largura - (perfilDescontoVidro * 2).toFixed(2);
                    alturaVidro3 = ((altura - perfilDescontoVidro - perfilPuxadorDescontoVidro - espDivisor) / 3).toFixed(2);
                    vidroCorte.push("1x " + vidro1Descricao + " " + larguraVidro1 + "x" + alturaVidro1 + "mm");
                    vidroCorte.push("1x " + vidro2Descricao + " " + larguraVidro2 + "x" + alturaVidro2 + "mm");
                    vidroCorte.push("1x " + vidro3Descricao + " " + larguraVidro3 + "x" + alturaVidro3 + "mm");
                }
            } else if (tipoDivisor === "Oculto") {
                divisor = largura - (perfilLarguraPerfil * 2).toFixed(2);
                divisorCorte.push("2x " + divisorDescricao + " " + divisor + "mm");
                if ($('#id_vidro').val()) {
                        larguraVidro = largura - (perfilDescontoVidro * 2).toFixed(2);
                        alturaVidro = (altura - perfilDescontoVidro - perfilPuxadorDescontoVidro).toFixed(2);
                        vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                }
            }
        }
    } else if ($('#posicao-perfilpuxador').val() === "Direita" || $('#posicao-perfilpuxador').val() === "Esquerda") {
        if ($('#qtd-divisor').val() === null || $('#qtd-divisor').val() === undefined || $('#qtd-divisor').val() === '') {
            perfilCorte.push("1x " + perfilDescricao + " " + altura + "mm");
            perfilCorte.push("2x " + perfilDescricao + " " + (largura - perfilPuxadorLarguraPuxador) + "mm");
            perfilPuxadorCorte.push("1x " + perfilPuxadorDescricao + " " + altura + "mm");
            if ($('#id_vidro').val()) {
                larguraVidro = (largura - perfilDescontoVidro - perfilPuxadorDescontoVidro).toFixed(2);
                alturaVidro = altura - (perfilDescontoVidro * 2).toFixed(2);
                vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
            }
        } else if ($('#qtd-divisor').val() === '1') {
            perfilCorte.push("1x " + perfilDescricao + " " + altura + "mm");
            perfilCorte.push("2x " + perfilDescricao + " " + (largura - perfilPuxadorLarguraPuxador) + "mm");
            perfilPuxadorCorte.push("1x " + perfilPuxadorDescricao + " " + altura + "mm");
            if (tipoDivisor === "Aparente") {
                divisor = (largura - perfilPuxadorLarguraPuxador - perfilAbaPerfil - perfilPuxadorAbaPerfil).toFixed(2);
                extrusao = perfilLarguraPerfil - perfilAbaPerfil.toFixed(2);
                divisorCorte.push("1x " + divisorDescricao + " " + divisor + "mm ("+ extrusao + "mm)");
                if ($('#id_vidro1').val() && $('#id_vidro2').val()) {
                    larguraVidro1 = (largura - perfilDescontoVidro - perfilPuxadorDescontoVidro).toFixed(2);
                    alturaVidro1 = ((altura - perfilDescontoVidro - perfilPuxadorDescontoVidro - espDivisor) / 2).toFixed(2);
                    larguraVidro2 = (largura - perfilDescontoVidro - perfilPuxadorDescontoVidro).toFixed(2);
                    alturaVidro2 = ((altura - perfilDescontoVidro - perfilPuxadorDescontoVidro - espDivisor) / 2).toFixed(2);
                    vidroCorte.push("1x " + vidro1Descricao + " " + larguraVidro1 + "x" + alturaVidro1 + "mm");
                    vidroCorte.push("1x " + vidro2Descricao + " " + larguraVidro2 + "x" + alturaVidro2 + "mm");
                }
            } else if (tipoDivisor === "Oculto") {
                divisor = (largura - perfilLarguraPerfil - perfilPuxadorLarguraPerfil - perfilPuxadorLarguraPuxador);
                divisorCorte.push("1x " + divisorDescricao + " " + divisor + "mm");
                if ($('#id_vidro').val()) {
                        larguraVidro = (largura - perfilDescontoVidro - perfilPuxadorDescontoVidro).toFixed(2);
                        alturaVidro = (altura - (perfilDescontoVidro * 2)).toFixed(2);
                        vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                }
            }
        } else if ($('#qtd-divisor').val() === '2') {
            perfilCorte.push("1x " + perfilDescricao + " " + altura + "mm");
            perfilCorte.push("2x " + perfilDescricao + " " + (largura - perfilPuxadorLarguraPuxador) + "mm");
            perfilPuxadorCorte.push("1x " + perfilPuxadorDescricao + " " + altura + "mm");
            if (tipoDivisor === "Aparente") {
                divisor = (largura - perfilPuxadorLarguraPuxador - perfilAbaPerfil - perfilPuxadorAbaPerfil).toFixed(2);
                extrusao = perfilLarguraPerfil - perfilAbaPerfil.toFixed(2);
                divisorCorte.push("2x " + divisorDescricao + " " + divisor + "mm ("+ extrusao + "mm)");
                if ($('#id_vidro1').val() && $('#id_vidro2').val()) {
                    larguraVidro1 = (largura - perfilDescontoVidro - perfilPuxadorDescontoVidro).toFixed(2);
                    alturaVidro1 = ((altura - perfilDescontoVidro - perfilPuxadorDescontoVidro - espDivisor) / 2).toFixed(2);
                    larguraVidro2 = (largura - perfilDescontoVidro - perfilPuxadorDescontoVidro).toFixed(2);
                    alturaVidro2 = ((altura - perfilDescontoVidro - perfilPuxadorDescontoVidro - espDivisor) / 2).toFixed(2);
                    larguraVidro3 = (largura - perfilDescontoVidro - perfilPuxadorDescontoVidro).toFixed(2);
                    alturaVidro3 = ((altura - perfilDescontoVidro - perfilPuxadorDescontoVidro - espDivisor) / 2).toFixed(2);
                    vidroCorte.push("1x " + vidro1Descricao + " " + larguraVidro1 + "x" + alturaVidro1 + "mm");
                    vidroCorte.push("1x " + vidro2Descricao + " " + larguraVidro2 + "x" + alturaVidro2 + "mm");
                    vidroCorte.push("1x " + vidro3Descricao + " " + larguraVidro3 + "x" + alturaVidro3 + "mm");
                }
            } else if (tipoDivisor === "Oculto") {
                divisor = (largura - perfilLarguraPerfil - perfilPuxadorLarguraPerfil - perfilPuxadorLarguraPuxador);
                divisorCorte.push("2x " + divisorDescricao + " " + divisor + "mm");
                if ($('#id_vidro').val()) {
                        larguraVidro = (largura - perfilDescontoVidro - perfilPuxadorDescontoVidro).toFixed(2);
                        alturaVidro = (altura - (perfilDescontoVidro * 2)).toFixed(2);
                        vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                }
            }
        }
    } else if ($('#posicao-perfilpuxador').val() === "Esq/Dir") {
        if ($('#qtd-divisor').val() === null || $('#qtd-divisor').val() === undefined || $('#qtd-divisor').val() === '') {
            perfilCorte.push("2x " + perfilDescricao + " " + (largura - (perfilPuxadorLarguraPuxador * 2)) + "mm");
            perfilPuxadorCorte.push("2x " + perfilDescricao + " " + altura + "mm");
            if ($('#id_vidro').val()) {
                larguraVidro = largura - (perfilPuxadorDescontoVidro * 2).toFixed(2);
                alturaVidro = altura - (perfilDescontoVidro * 2).toFixed(2);
                vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
            }
        } else if ($('#qtd-divisor').val() === '1') {
            perfilCorte.push("2x " + perfilDescricao + " " + (largura - (perfilPuxadorLarguraPuxador * 2)) + "mm");
            perfilPuxadorCorte.push("2x " + perfilDescricao + " " + altura + "mm");
            if (tipoDivisor === "Aparente") {
                divisor = (largura - (perfilPuxadorLarguraPuxador * 2) - (perfilPuxadorAbaPerfil * 2)).toFixed(2);
                extrusao = (perfilPuxadorLarguraPerfil - perfilPuxadorAbaPerfil).toFixed(2);
                divisorCorte.push("1x " + divisorDescricao + " " + divisor + "mm ("+ extrusao + "mm)");
                if ($('#id_vidro1').val() && $('#id_vidro2').val()) {
                    larguraVidro1 = (largura - (perfilPuxadorDescontoVidro * 2)).toFixed(2);
                    alturaVidro1 = ((altura - (perfilDescontoVidro * 2) - espDivisor) / 2).toFixed(2);
                    larguraVidro2 = (largura - (perfilPuxadorDescontoVidro * 2)).toFixed(2);
                    alturaVidro2 = ((altura - (perfilDescontoVidro * 2) - espDivisor) / 2).toFixed(2);
                    vidroCorte.push("1x " + vidro1Descricao + " " + larguraVidro1 + "x" + alturaVidro1 + "mm");
                    vidroCorte.push("1x " + vidro2Descricao + " " + larguraVidro2 + "x" + alturaVidro2 + "mm");
                }
            } else if (tipoDivisor === "Oculto") {
                divisor = (largura - (perfilPuxadorLarguraPerfil * 2) - (perfilPuxadorLarguraPuxador * 2));
                divisorCorte.push("1x " + divisorDescricao + " " + divisor + "mm");
                if ($('#id_vidro').val()) {
                        larguraVidro = (largura - (perfilPuxadorDescontoVidro * 2)).toFixed(2);
                        alturaVidro = (altura - (perfilDescontoVidro * 2)).toFixed(2);
                        vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                }
            }
        } else if ($('#qtd-divisor').val() === '2') {
            perfilCorte.push("2x " + perfilDescricao + " " + (largura - (perfilPuxadorLarguraPuxador * 2)) + "mm");
            perfilPuxadorCorte.push("2x " + perfilDescricao + " " + altura + "mm");
            if (tipoDivisor === "Aparente") {
                divisor = (largura - (perfilPuxadorLarguraPuxador * 2) - (perfilPuxadorAbaPerfil * 2)).toFixed(2);
                extrusao = (perfilPuxadorLarguraPerfil - perfilPuxadorAbaPerfil).toFixed(2);
                divisorCorte.push("2x " + divisorDescricao + " " + divisor + "mm ("+ extrusao + "mm)");
                if ($('#id_vidro1').val() && $('#id_vidro2').val()) {
                    larguraVidro1 = (largura - (perfilPuxadorDescontoVidro * 2)).toFixed(2);
                    alturaVidro1 = ((altura - (perfilDescontoVidro * 2) - espDivisor) / 2).toFixed(2);
                    larguraVidro2 = (largura - (perfilPuxadorDescontoVidro * 2)).toFixed(2);
                    alturaVidro2 = ((altura - (perfilDescontoVidro * 2) - espDivisor) / 2).toFixed(2);
                    vidroCorte.push("1x " + vidro1Descricao + " " + larguraVidro1 + "x" + alturaVidro1 + "mm");
                    vidroCorte.push("1x " + vidro2Descricao + " " + larguraVidro2 + "x" + alturaVidro2 + "mm");
                }
            } else if (tipoDivisor === "Oculto") {
                divisor = (largura - (perfilPuxadorLarguraPerfil * 2) - (perfilPuxadorLarguraPuxador * 2));
                divisorCorte.push("2x " + divisorDescricao + " " + divisor + "mm");
                if ($('#id_vidro').val()) {
                        larguraVidro = (largura - (perfilPuxadorDescontoVidro * 2)).toFixed(2);
                        alturaVidro = (altura - (perfilDescontoVidro * 2)).toFixed(2);
                        vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                }
            }
        }
    } else if ($('#posicao-puxador').val() === "Topo" || $('#posicao-puxador').val() === "Base") {
        if (tamPuxador < largura) {
            if ($('#qtd-divisor').val() === null || $('#qtd-divisor').val() === undefined || $('#qtd-divisor').val() === '') {
            perfilCorte.push("2x " + perfilDescricao + " " + largura + "mm");
            perfilCorte.push("2x " + perfilDescricao + " " + altura + "mm");
            puxadorCorte.push("1x " + puxadorDescricao + " " + tamPuxador + "mm");
                if ($('#id_vidro').val()) {
                    larguraVidro = largura - (perfilDescontoVidro * 2).toFixed(2);
                    alturaVidro = altura - (perfilDescontoVidro * 2).toFixed(2);
                    vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                }
            } else if ($('#qtd-divisor').val() === '1') {
                perfilCorte.push("2x " + perfilDescricao + " " + largura + "mm");
                perfilCorte.push("2x " + perfilDescricao + " " + altura + "mm");
                puxadorCorte.push("1x " + puxadorDescricao + " " + tamPuxador + "mm");
                if (tipoDivisor === "Aparente") {
                    divisor = largura - (perfilAbaPerfil * 2).toFixed(2);
                    extrusao = perfilLarguraPerfil - perfilAbaPerfil.toFixed(2);
                    divisorCorte.push("1x " + divisorDescricao + " " + divisor + "mm ("+ extrusao + "mm)");
                    if ($('#id_vidro1').val() && $('#id_vidro2').val()) {
                        larguraVidro1 = largura - (perfilDescontoVidro * 2).toFixed(2);
                        alturaVidro1 = ((altura - perfilDescontoVidro - espDivisor) / 2).toFixed(2);
                        larguraVidro2 = largura - (perfilDescontoVidro * 2).toFixed(2);
                        alturaVidro2 = ((altura - perfilDescontoVidro - espDivisor) / 2).toFixed(2);
                        vidroCorte.push("1x " + vidro1Descricao + " " + larguraVidro1 + "x" + alturaVidro1 + "mm");
                        vidroCorte.push("1x " + vidro2Descricao + " " + larguraVidro2 + "x" + alturaVidro2 + "mm");
                    }
                } else if (tipoDivisor === "Oculto") {
                    divisor = largura - (perfilLarguraPerfil * 2).toFixed(2);
                    divisorCorte.push("1x " + divisorDescricao + " " + divisor + "mm");
                    if ($('#id_vidro').val()) {
                        larguraVidro = largura - (perfilDescontoVidro * 2).toFixed(2);
                        alturaVidro = altura - (perfilDescontoVidro * 2).toFixed(2);
                        vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                    }
                }
            } else if ($('#qtd-divisor').val() === '2') {
                perfilCorte.push("2x " + perfilDescricao + " " + largura + "mm");
                perfilCorte.push("2x " + perfilDescricao + " " + altura + "mm");
                puxadorCorte.push("1x " + puxadorDescricao + " " + tamPuxador + "mm");
                if (tipoDivisor === "Aparente") {
                    divisor = largura - (perfilAbaPerfil * 2).toFixed(2);
                    extrusao = perfilLarguraPerfil - perfilAbaPerfil.toFixed(2);
                    divisorCorte.push("2x " + divisorDescricao + " " + divisor + "mm ("+ extrusao + "mm)");
                    if ($('#id_vidro1').val() && $('#id_vidro2').val() && $('#id_vidro3').val()) {
                        larguraVidro1 = (largura - (perfilDescontoVidro * 2)).toFixed(2);
                        alturaVidro1 = ((altura - perfilDescontoVidro - espDivisor) / 3).toFixed(2);
                        larguraVidro2 = (largura - (perfilDescontoVidro * 2)).toFixed(2);
                        alturaVidro2 = ((altura - perfilDescontoVidro - espDivisor) / 3).toFixed(2);
                        larguraVidro3 = (largura - (perfilDescontoVidro * 2)).toFixed(2);
                        alturaVidro3 = ((altura - perfilDescontoVidro - espDivisor) / 3).toFixed(2);
                        vidroCorte.push("1x " + vidro1Descricao + " " + larguraVidro1 + "x" + alturaVidro1 + "mm");
                        vidroCorte.push("1x " + vidro2Descricao + " " + larguraVidro2 + "x" + alturaVidro2 + "mm");
                        vidroCorte.push("1x " + vidro3Descricao + " " + larguraVidro3 + "x" + alturaVidro3 + "mm");
                    }
                } else if (tipoDivisor === "Oculto") {
                    divisor = largura - (perfilLarguraPerfil * 2).toFixed(2);
                    divisorCorte.push("2x" + divisorDescricao + " " + divisor + "mm");
                    if ($('#id_vidro').val()) {
                        larguraVidro = largura - (perfilDescontoVidro * 2).toFixed(2);
                        alturaVidro = altura - (perfilDescontoVidro * 2).toFixed(2);
                        vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                    }
                }
            }
        } else if (tamPuxador === largura) {
            if ($('#qtd-divisor').val() === null || $('#qtd-divisor').val() === undefined || $('#qtd-divisor').val() === '') {
            perfilCorte.push("2x " + perfilDescricao + " " + largura + "mm");
            perfilCorte.push("2x " + perfilDescricao + " " + (altura - descontoPuxador) + "mm");
            puxadorCorte.push("1x " + puxadorDescricao + " " + tamPuxador + "mm");
                if ($('#id_vidro').val()) {
                    larguraVidro = largura - (perfilDescontoVidro * 2).toFixed(2);
                    alturaVidro = (altura - descontoPuxador - (perfilDescontoVidro * 2)).toFixed(2);
                    vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                }
            } else if ($('#qtd-divisor').val() === '1') {
                perfilCorte.push("2x " + perfilDescricao + " " + largura + "mm");
                perfilCorte.push("2x " + perfilDescricao + " " + (altura - descontoPuxador) + "mm");
                puxadorCorte.push("1x " + puxadorDescricao + " " + tamPuxador + "mm");
                if (tipoDivisor === "Aparente") {
                    divisor = largura - (perfilAbaPerfil * 2).toFixed(2);
                    extrusao = perfilLarguraPerfil - perfilAbaPerfil.toFixed(2);
                    divisorCorte.push("1x " + divisorDescricao + " " + divisor + "mm ("+ extrusao + "mm)");
                    if ($('#id_vidro1').val() && $('#id_vidro2').val()) {
                        larguraVidro1 = largura - (perfilDescontoVidro * 2).toFixed(2);
                        alturaVidro1 = ((altura - perfilDescontoVidro - espDivisor - descontoPuxador) / 2).toFixed(2);
                        larguraVidro2 = largura - (perfilDescontoVidro * 2).toFixed(2);
                        alturaVidro2 = ((altura - perfilDescontoVidro - espDivisor - descontoPuxador) / 2).toFixed(2);
                        vidroCorte.push("1x " + vidro1Descricao + " " + larguraVidro1 + "x" + alturaVidro1 + "mm");
                        vidroCorte.push("1x " + vidro2Descricao + " " + larguraVidro2 + "x" + alturaVidro2 + "mm");
                    }
                } else if (tipoDivisor === "Oculto") {
                    divisor = largura - (perfilLarguraPerfil * 2).toFixed(2);
                    divisorCorte.push("1x " + divisorDescricao + " " + divisor + "mm");
                    if ($('#id_vidro').val()) {
                        larguraVidro = largura - (perfilDescontoVidro * 2).toFixed(2);
                        alturaVidro = (altura - (perfilDescontoVidro * 2) - descontoPuxador).toFixed(2);
                        vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                    }
                }
            } else if ($('#qtd-divisor').val() === '2') {
                perfilCorte.push("2x " + perfilDescricao + " " + largura + "mm");
                perfilCorte.push("2x " + perfilDescricao + " " + (altura - descontoPuxador) + "mm");
                puxadorCorte.push("1x " + puxadorDescricao + " " + tamPuxador + "mm");
                if (tipoDivisor === "Aparente") {
                    divisor = largura - (perfilAbaPerfil * 2).toFixed(2);
                    extrusao = perfilLarguraPerfil - perfilAbaPerfil.toFixed(2);
                    divisorCorte.push("2x " + divisorDescricao + " " + divisor + "mm ("+ extrusao + "mm)");
                    if ($('#id_vidro1').val() && $('#id_vidro2').val() && $('#id_vidro3').val()) {
                        larguraVidro1 = (largura - (perfilDescontoVidro * 2)).toFixed(2);
                        alturaVidro1 = ((altura - perfilDescontoVidro - espDivisor - descontoPuxador) / 3).toFixed(2);
                        larguraVidro2 = (largura - (perfilDescontoVidro * 2)).toFixed(2);
                        alturaVidro2 = ((altura - perfilDescontoVidro - espDivisor - descontoPuxador) / 3).toFixed(2);
                        larguraVidro3 = (largura - (perfilDescontoVidro * 2)).toFixed(2);
                        alturaVidro3 = ((altura - perfilDescontoVidro - espDivisor - descontoPuxador) / 3).toFixed(2);
                        vidroCorte.push("1x " + vidro1Descricao + " " + larguraVidro1 + "x" + alturaVidro1 + "mm");
                        vidroCorte.push("1x " + vidro2Descricao + " " + larguraVidro2 + "x" + alturaVidro2 + "mm");
                        vidroCorte.push("1x " + vidro3Descricao + " " + larguraVidro3 + "x" + alturaVidro3 + "mm");
                    }
                } else if (tipoDivisor === "Oculto") {
                    divisor = largura - (perfilLarguraPerfil * 2).toFixed(2);
                    divisorCorte.push("2x" + divisorDescricao + " " + divisor + "mm");
                    if ($('#id_vidro').val()) {
                        larguraVidro = largura - (perfilDescontoVidro * 2).toFixed(2);
                        alturaVidro = (altura - (perfilDescontoVidro * 2) - descontoPuxador).toFixed(2);
                        vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                    }
                }
            }
        }
    } else if ($('#posicao-puxador').val() === "Esquerda" || $('#posicao-puxador').val() === "Direita") {
        if (tamPuxador < largura) {
            if ($('#qtd-divisor').val() === null || $('#qtd-divisor').val() === undefined || $('#qtd-divisor').val() === '') {
            perfilCorte.push("2x " + perfilDescricao + " " + largura + "mm");
            perfilCorte.push("2x " + perfilDescricao + " " + altura + "mm");
            puxadorCorte.push("1x " + puxadorDescricao + " " + tamPuxador + "mm");
                if ($('#id_vidro').val()) {
                    larguraVidro = largura - (perfilDescontoVidro * 2).toFixed(2);
                    alturaVidro = altura - (perfilDescontoVidro * 2).toFixed(2);
                    vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                }
            } else if ($('#qtd-divisor').val() === '1') {
                perfilCorte.push("2x " + perfilDescricao + " " + largura + "mm");
                perfilCorte.push("2x " + perfilDescricao + " " + altura + "mm");
                puxadorCorte.push("1x " + puxadorDescricao + " " + tamPuxador + "mm");
                if (tipoDivisor === "Aparente") {
                    divisor = largura - (perfilAbaPerfil * 2).toFixed(2);
                    extrusao = perfilLarguraPerfil - perfilAbaPerfil.toFixed(2);
                    divisorCorte.push("1x " + divisorDescricao + " " + divisor + "mm ("+ extrusao + "mm)");
                    if ($('#id_vidro1').val() && $('#id_vidro2').val()) {
                        larguraVidro1 = largura - (perfilDescontoVidro * 2).toFixed(2);
                        alturaVidro1 = ((altura - perfilDescontoVidro - espDivisor) / 2).toFixed(2);
                        larguraVidro2 = largura - (perfilDescontoVidro * 2).toFixed(2);
                        alturaVidro2 = ((altura - perfilDescontoVidro - espDivisor) / 2).toFixed(2);
                        vidroCorte.push("1x " + vidro1Descricao + " " + larguraVidro1 + "x" + alturaVidro1 + "mm");
                        vidroCorte.push("1x " + vidro2Descricao + " " + larguraVidro2 + "x" + alturaVidro2 + "mm");
                    }
                } else if (tipoDivisor === "Oculto") {
                    divisor = largura - (perfilLarguraPerfil * 2).toFixed(2);
                    divisorCorte.push("1x " + divisorDescricao + " " + divisor + "mm");
                    if ($('#id_vidro').val()) {
                        larguraVidro = largura - (perfilDescontoVidro * 2).toFixed(2);
                        alturaVidro = altura - (perfilDescontoVidro * 2).toFixed(2);
                        vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                    }
                }
            } else if ($('#qtd-divisor').val() === '2') {
                perfilCorte.push("2x " + perfilDescricao + " " + largura + "mm");
                perfilCorte.push("2x " + perfilDescricao + " " + altura + "mm");
                puxadorCorte.push("1x " + puxadorDescricao + " " + tamPuxador + "mm");
                if (tipoDivisor === "Aparente") {
                    divisor = largura - (perfilAbaPerfil * 2).toFixed(2);
                    extrusao = perfilLarguraPerfil - perfilAbaPerfil.toFixed(2);
                    divisorCorte.push("2x " + divisorDescricao + " " + divisor + "mm ("+ extrusao + "mm)");
                    if ($('#id_vidro1').val() && $('#id_vidro2').val() && $('#id_vidro3').val()) {
                        larguraVidro1 = (largura - (perfilDescontoVidro * 2)).toFixed(2);
                        alturaVidro1 = ((altura - perfilDescontoVidro - espDivisor) / 3).toFixed(2);
                        larguraVidro2 = (largura - (perfilDescontoVidro * 2)).toFixed(2);
                        alturaVidro2 = ((altura - perfilDescontoVidro - espDivisor) / 3).toFixed(2);
                        larguraVidro3 = (largura - (perfilDescontoVidro * 2)).toFixed(2);
                        alturaVidro3 = ((altura - perfilDescontoVidro - espDivisor) / 3).toFixed(2);
                        vidroCorte.push("1x " + vidro1Descricao + " " + larguraVidro1 + "x" + alturaVidro1 + "mm");
                        vidroCorte.push("1x " + vidro2Descricao + " " + larguraVidro2 + "x" + alturaVidro2 + "mm");
                        vidroCorte.push("1x " + vidro3Descricao + " " + larguraVidro3 + "x" + alturaVidro3 + "mm");
                    }
                } else if (tipoDivisor === "Oculto") {
                    divisor = largura - (perfilLarguraPerfil * 2).toFixed(2);
                    divisorCorte.push("2x" + divisorDescricao + " " + divisor + "mm");
                    if ($('#id_vidro').val()) {
                        larguraVidro = largura - (perfilDescontoVidro * 2).toFixed(2);
                        alturaVidro = altura - (perfilDescontoVidro * 2).toFixed(2);
                        vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                    }
                }
            }
        } else if (tamPuxador === largura) {
            if ($('#qtd-divisor').val() === null || $('#qtd-divisor').val() === undefined || $('#qtd-divisor').val() === '') {
            perfilCorte.push("2x " + perfilDescricao + " " + (largura - descontoPuxador) + "mm");
            perfilCorte.push("2x " + perfilDescricao + " " + altura + "mm");
            puxadorCorte.push("1x " + puxadorDescricao + " " + tamPuxador + "mm");
                if ($('#id_vidro').val()) {
                    larguraVidro = (largura - descontoPuxador - (perfilDescontoVidro * 2)).toFixed(2);
                    alturaVidro = altura - (perfilDescontoVidro * 2).toFixed(2);
                    vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                }
            } else if ($('#qtd-divisor').val() === '1') {
                perfilCorte.push("2x " + perfilDescricao + " " + (largura - descontoPuxador) + "mm");
                perfilCorte.push("2x " + perfilDescricao + " " + altura + "mm");
                puxadorCorte.push("1x " + puxadorDescricao + " " + tamPuxador + "mm");
                if (tipoDivisor === "Aparente") {
                    divisor = largura - (perfilAbaPerfil * 2).toFixed(2);
                    extrusao = perfilLarguraPerfil - perfilAbaPerfil.toFixed(2);
                    divisorCorte.push("1x " + divisorDescricao + " " + divisor + "mm ("+ extrusao + "mm)");
                    if ($('#id_vidro1').val() && $('#id_vidro2').val()) {
                        larguraVidro1 = (largura - descontoPuxador - (perfilDescontoVidro * 2)).toFixed(2);
                        alturaVidro1 = ((altura - perfilDescontoVidro - espDivisor) / 2).toFixed(2);
                        larguraVidro2 = (largura - descontoPuxador - (perfilDescontoVidro * 2)).toFixed(2);
                        alturaVidro2 = ((altura - perfilDescontoVidro - espDivisor) / 2).toFixed(2);
                        vidroCorte.push("1x " + vidro1Descricao + " " + larguraVidro1 + "x" + alturaVidro1 + "mm");
                        vidroCorte.push("1x " + vidro2Descricao + " " + larguraVidro2 + "x" + alturaVidro2 + "mm");
                    }
                } else if (tipoDivisor === "Oculto") {
                    divisor = largura - (perfilLarguraPerfil * 2).toFixed(2);
                    divisorCorte.push("1x " + divisorDescricao + " " + divisor + "mm");
                    if ($('#id_vidro').val()) {
                        larguraVidro = (largura - (perfilDescontoVidro * 2) - descontoPuxador).toFixed(2);
                        alturaVidro = altura - (perfilDescontoVidro * 2).toFixed(2);
                        vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                    }
                }
            } else if ($('#qtd-divisor').val() === '2') {
                perfilCorte.push("2x " + perfilDescricao + " " + (largura - descontoPuxador) + "mm");
                perfilCorte.push("2x " + perfilDescricao + " " + altura + "mm");
                puxadorCorte.push("1x " + puxadorDescricao + " " + tamPuxador + "mm");
                if (tipoDivisor === "Aparente") {
                    divisor = largura - (perfilAbaPerfil * 2).toFixed(2);
                    extrusao = perfilLarguraPerfil - perfilAbaPerfil.toFixed(2);
                    divisorCorte.push("2x " + divisorDescricao + " " + divisor + "mm ("+ extrusao + "mm)");
                    if ($('#id_vidro1').val() && $('#id_vidro2').val() && $('#id_vidro3').val()) {
                        larguraVidro1 = (largura - (perfilDescontoVidro * 2) - descontoPuxador).toFixed(2);
                        alturaVidro1 = ((altura - perfilDescontoVidro - espDivisor) / 3).toFixed(2);
                        larguraVidro2 = (largura - (perfilDescontoVidro * 2) - descontoPuxador).toFixed(2);
                        alturaVidro2 = ((altura - perfilDescontoVidro - espDivisor) / 3).toFixed(2);
                        larguraVidro3 = (largura - (perfilDescontoVidro * 2) - descontoPuxador).toFixed(2);
                        alturaVidro3 = ((altura - perfilDescontoVidro - espDivisor) / 3).toFixed(2);
                        vidroCorte.push("1x " + vidro1Descricao + " " + larguraVidro1 + "x" + alturaVidro1 + "mm");
                        vidroCorte.push("1x " + vidro2Descricao + " " + larguraVidro2 + "x" + alturaVidro2 + "mm");
                        vidroCorte.push("1x " + vidro3Descricao + " " + larguraVidro3 + "x" + alturaVidro3 + "mm");
                    }
                } else if (tipoDivisor === "Oculto") {
                    divisor = largura - (perfilLarguraPerfil * 2).toFixed(2);
                    divisorCorte.push("2x" + divisorDescricao + " " + divisor + "mm");
                    if ($('#id_vidro').val()) {
                        larguraVidro = (largura - (perfilDescontoVidro * 2) - descontoPuxador).toFixed(2);
                        alturaVidro = (altura - (perfilDescontoVidro * 2)).toFixed(2);
                        vidroCorte.push("1x " + vidroDescricao + " " + larguraVidro + "x" + alturaVidro + "mm");
                    }
                }
            }
        }
    }
}
$(document).ready(function() {
    $('#id_largura, #id_altura, #id_perfil, #id_perfilpuxador, #qtd-perfilpuxador, #posicao-perfilpuxador, #id_puxador, #qtd-puxador, #posicao-puxador, #tam-puxador, #id_vidro, #id_vidro1, #id_vidro2, #id_vidro3, #id_divisor, #qtd-divisor').change(function() {
        calcularMaterial();
    });
});
</script>

<script>
$(document).ready(function() {

    var ultimoIdOrcamento = 0;

    function adicionarItemTabela(descricao, quantidade, valor) {
        if (!descricao || !quantidade || !valor) {
            alert("Preencha todos os campos obrigatórios para a tabela Orçamento.");
            return;
        }

        var tabela = $("#tabelaOrcamento");
        var novoId = ultimoIdOrcamento + 1;

        var novaLinha = "<tr data-id='" + novoId + "'>" +
            "<th scope='row'>" + novoId + "</th>" +
            "<td>" + quantidade + "</td>" +
            "<td>" + descricao + "</td>" +
            "<td class='valor text-end'>" + valor + "</td>" +
            "<td><button class='btn btn-danger btn-sm btn-excluir d-flex align-items-center' data-id='" + novoId + "' title='Excluir' style='height: 20px;'>X</button></td>" +
            "</tr>";

        tabela.find("tbody").append(novaLinha);

        ultimoIdOrcamento = novoId;

        return novoId;
    }

    function adicionarItemInsumos(idOrcamento, dadosItem) {
        if (idOrcamento === -1 || !dadosItem.nome || !dadosItem.quantidadeUtilizada || !dadosItem.preco) {
            alert("Os dados do item são inválidos para a tabela Insumos.");
            return -1;
        }

        var novaLinha = "<tr data-id-orcamento='" + idOrcamento + "'>" +
            "<td>" + idOrcamento + "</td>" +
            "<td>" + dadosItem.codigo + "</td>" +
            "<td>" + dadosItem.nome + "</td>" +
            "<td class='text-end'>" + dadosItem.quantidadeUtilizada.toFixed(2) + "</td>" +
            "<td class='text-end'>" + dadosItem.preco.toFixed(2) + "</td>" +
            "<td class='text-end'>" + (dadosItem.quantidadeUtilizada * dadosItem.preco).toFixed(2) + "</td>" +
            "</tr>";

        $("#tabelaInsumos tbody").append(novaLinha);
    }

    function obterDadosItem(tipoItem) {
        var dados = {
            codigo: "",
            nome: "",
            descricao: "",
            preco: 0,
            quantidadeUtilizada: 0
        };

        switch (tipoItem) {
            case "perfil":
                if (perfilusado > 0) {
                    dados.id = $("#id_perfil").val();
                    dados.codigo = String($('#id_perfil option:selected').data('item')?.codigo).padStart(6, '0') || '000000';
                    dados.nome = $('#id_perfil option:selected').data('item')?.nome ?? '';
                    dados.preco = parseFloat($("#id_perfil option:selected").data('item')?.preco || 0);
                    dados.quantidadeUtilizada = perfilusado;
                }
                break;
            case "perfilpuxador":
                if (perfilpuxadorusado > 0) {
                    dados.id = $("#id_perfilpuxador").val();
                    dados.codigo = String($('#id_perfilpuxador option:selected').data('item')?.codigo).padStart(6, '0') || '000000';
                    dados.nome = $('#id_perfilpuxador option:selected').data('item')?.nome ?? '';
                    dados.preco = parseFloat($("#id_perfilpuxador option:selected").data('item')?.preco || 0);
                    dados.quantidadeUtilizada = perfilpuxadorusado;
                }
                break;
            case "puxador":
                if (puxadorusado > 0) {
                    dados.id = $("#id_puxador").val();
                    dados.codigo = String($('#id_puxador option:selected').data('item')?.codigo).padStart(6, '0') || '000000';
                    dados.nome = $('#id_puxador option:selected').data('item')?.nome ?? '';
                    dados.preco = parseFloat($("#id_puxador option:selected").data('item')?.preco || 0);
                    dados.quantidadeUtilizada = puxadorusado;
                }
                break;
            case "divisor":
                if (divisorusado > 0) {
                    dados.id = $("#id_divisor").val();
                    dados.codigo = String($('#id_divisor option:selected').data('item')?.codigo).padStart(6, '0') || '000000';
                    dados.nome = $('#id_divisor option:selected').data('item')?.nome ?? '';
                    dados.preco = parseFloat($("#id_divisor option:selected").data('item')?.preco || 0);
                    dados.quantidadeUtilizada = divisorusado;
                }
                break;
            case "vidro":
                if (vidrousado > 0) {
                    dados.id = $("#id_vidro").val();
                    dados.codigo = String($('#id_vidro option:selected').data('codigo')).padStart(6, '0') || '000000';
                    dados.nome = ($('#id_vidro option:selected').data('nome') || 0);
                    dados.preco = parseFloat($('#id_vidro option:selected').data('preco') || 0);
                    dados.quantidadeUtilizada = vidrousado;
                }
                break;
            case "vidro1":
                if (vidrousado1 > 0) {
                    dados.id = $("#id_vidro1").val();
                    dados.codigo = String($('#id_vidro1 option:selected').data('codigo')).padStart(6, '0') || '000000';
                    dados.nome = ($('#id_vidro1 option:selected').data('nome') || 0);
                    dados.preco = parseFloat($('#id_vidro1 option:selected').data('preco') || 0);
                    dados.quantidadeUtilizada = vidrousado1;
                }
                break;
            case "vidro2":
                if (vidrousado2 > 0) {
                    dados.id = $("#id_vidro2").val();
                    dados.codigo = String($('#id_vidro2 option:selected').data('codigo')).padStart(6, '0') || '000000';
                    dados.nome = ($('#id_vidro2 option:selected').data('nome') || 0);
                    dados.preco = parseFloat($('#id_vidro2 option:selected').data('preco') || 0);
                    dados.quantidadeUtilizada = vidrousado2;
                }
                break;
            case "vidro3":
                if (vidrousado3 > 0) {
                    dados.id = $("#id_vidro3").val();
                    dados.codigo = String($('#id_vidro3 option:selected').data('codigo')).padStart(6, '0') || '000000';
                    dados.nome = ($('#id_vidro3 option:selected').data('nome') || 0);
                    dados.preco = parseFloat($('#id_vidro3 option:selected').data('preco') || 0);
                    dados.quantidadeUtilizada = vidrousado3;
                }
                break;
            default:
                console.error("Tipo de item não reconhecido:", tipoItem);
                break;
        }

        return dados;
    }

    // Manipulador de evento para o botão "Adicionar"
    $("#btnAdicionar").click(function() {
        // Verificar qual radiobutton está selecionado
        var selectedRadioButton = $("input[name='btnradio']:checked").val();

        // Verificar se os campos estão preenchidos de acordo com a seleção do radiobutton
        if (selectedRadioButton === "PortaGiro") {
            if ($("#id_quantidade").val() && $("#id_largura").val() && $("#id_altura").val() && $("#id_acabamento").val() && $("#id_abertura").val() && $("#id_perfil").val()) {
                var descricao = $("#nomeporta").text();
                var quantidade = $("#id_quantidade").val();
                var valor = $("#valorporta").text();


                // Validações adicionais
                if ($("#id_perfilpuxador").val()) {
                    if (!$("#qtd-perfilpuxador").val() || !$("#posicao-perfilpuxador").val()) {
                        alert("Preencha a quantidade e a posição do perfil puxador.");
                        return;
                    }
                }

                if ($("#id_puxador").val()) {
                    if (!$("#qtd-puxador").val() || !$("#posicao-puxador").val() || !$("#tam-puxador").val()) {
                        alert("Preencha a quantidade, a posição e o tamanho do puxador.");
                        return;
                    }
                }

                if ($("#qtd-divisor").val() == 1 && $("#id_vidro1").val()) {
                    if (!$("#id_vidro2").val()) {
                        alert("Preencha o segundo vidro.");
                        return;
                    }
                }

                if ($("#qtd-divisor").val() == 2 && $("#id_vidro1").val()) {
                    if (!$("#id_vidro2").val() || !$("#id_vidro3").val()) {
                        alert("Preencha o segundo e o terceiro vidro.");
                        return;
                    }
                }

                adicionarItemTabela(descricao, quantidade, valor);
            } else {
                alert("Preencha todos os campos obrigatórios.");
            }
        } else if (selectedRadioButton === "PortaCorrer") {
            if ($("#id_quantidade").val() && $("#id_largura").val() && $("#id_altura").val() && $("#id_acabamento").val() && $("#id_perfil").val()) {
                var descricao = $("#nomeporta").text();
                var quantidade = $("#id_quantidade").val();
                var valor = $("#valorporta").text();

                // Validações adicionais
                if ($("#id_perfilpuxador").val()) {
                    if (!$("#qtd-perfilpuxador").val() || !$("#posicao-perfilpuxador").val()) {
                        alert("Preencha a quantidade e a posição do perfil puxador.");
                        return;
                    }
                }

                if ($("#id_puxador").val()) {
                    if (!$("#qtd-puxador").val() || !$("#posicao-puxador").val() || !$("#tam-puxador").val()) {
                        alert("Preencha a quantidade, a posição e o tamanho do puxador.");
                        return;
                    }
                }

                if ($("#qtd-divisor").val() == 1 && $("#id_vidro1").val()) {
                    if (!$("#id_vidro2").val()) {
                        alert("Preencha o segundo vidro.");
                        return;
                    }
                }

                if ($("#qtd-divisor").val() == 2 && $("#id_vidro1").val()) {
                    if (!$("#id_vidro2").val() || !$("#id_vidro3").val()) {
                        alert("Preencha o segundo e o terceiro vidro.");
                        return;
                    }
                }

                adicionarItemTabela(descricao, quantidade, valor);

            } else {
                alert("Preencha todos os campos obrigatórios.");
            }
        } else if (selectedRadioButton === "Vidros") {
            if ($("#id_quantidade").val() && $("#id_largura").val() && $("#id_altura").val() && $("#id_vidro").val()) {
                var descricao = $("#nomeporta").text();
                var quantidade = $("#id_quantidade").val();
                var valor = $("#valorporta").text();

                // Validações adicionais
                if ($("#id_perfilpuxador").val()) {
                    if (!$("#qtd-perfilpuxador").val() || !$("#posicao-perfilpuxador").val()) {
                        alert("Preencha a quantidade e a posição do perfil puxador.");
                        return;
                    }
                }

                if ($("#id_puxador").val()) {
                    if (!$("#qtd-puxador").val() || !$("#posicao-puxador").val() || !$("#tam-puxador").val()) {
                        alert("Preencha a quantidade, a posição e o tamanho do puxador.");
                        return;
                    }
                }

                if ($("#qtd-divisor").val() == 1 && $("#id_vidro1").val()) {
                    if (!$("#id_vidro2").val()) {
                        alert("Preencha o segundo vidro.");
                        return;
                    }
                }

                if ($("#qtd-divisor").val() == 2 && $("#id_vidro1").val()) {
                    if (!$("#id_vidro2").val() || !$("#id_vidro3").val()) {
                        alert("Preencha o segundo e o terceiro vidro.");
                        return;
                    }
                }

                adicionarItemTabela(descricao, quantidade, valor);

                // Adicionar os itens na tabela de insumos
                var tiposItens = ["perfil", "perfilpuxador", "puxador", "divisor", "vidro", "vidro1", "vidro2", "vidro3"];
                tiposItens.forEach(function(tipoItem) {
                    var dadosItem = obterDadosItem(tipoItem);
                    if (dadosItem.quantidadeUtilizada > 0) {
                        adicionarItemInsumos(idOrcamento, dadosItem);
                    }
                });
            } else {
                alert("Preencha todos os campos obrigatórios.");
            }
        } else {
            alert("Selecione um tipo de porta.");
            return; // Retornar imediatamente se nenhum tipo de porta for selecionado
        }
         // Capturar o ID do item adicionado na tabela de orçamento
        idOrcamento = $("#tabelaOrcamento tbody tr:last").data("id");

        // Adicionar os itens na tabela de insumos usando o ID do orçamento
        var tiposItens = ["perfil", "perfilpuxador", "puxador", "divisor", "vidro", "vidro1", "vidro2", "vidro3"];
        tiposItens.forEach(function(tipoItem) {
            var dadosItem = obterDadosItem(tipoItem);
            if (dadosItem.quantidadeUtilizada > 0) {
                adicionarItemInsumos(idOrcamento, dadosItem);
            }
        });
        inicializarElementos();
    });
});
</script>

<script>
$(document).ready(function() {
    // Ao clicar no botão de busca do cliente, abre o modal
    $("#btnBuscarCliente").click(function() {
        $("#modalBuscaCliente").modal("show");
    });
});
</script>

<script>
$(document).ready(function() {
    $('#clienteInput').on('blur keydown', function(event) {
        // Verifica se a tecla pressionada é Enter (código 13)
        if (event.type === 'keydown' && event.keyCode !== 13) {
            return; // Se não for Enter, não faz nada
        }
        var codigoCliente = $('#clienteInput').val();
        $.ajax({
            url: '{% url "buscar-cliente" %}',
            data: {'codigo': codigoCliente},
            dataType: 'json',
            success: function(data) {
                if (data.nome) {
                    $('#nomeCliente').val(data.nome);
                } else {
                    $('#nomeCliente').val('');
                    alert('Código de cliente não encontrado.');
                }
            }
        });
    });
});
</script>

<script>
// Função para verificar se o valor está vazio e adicionar ou remover a classe 'st2' em '#cifraoporta'
function cifraopreco() {
    var valor = $("#valorporta").text().trim();
    var cifrao = $("#cifraoporta");

    if (valor !== "") {
        cifrao.removeClass("st2");
    } else {
        cifrao.addClass("st2");
    }
}

// Criar um novo MutationObserver
var observer = new MutationObserver(function(mutations) {
    mutations.forEach(function(mutation) {
        // Chamar a função cifraopreco quando houver alterações no conteúdo do elemento
        cifraopreco();
    });
});

// Observar mudanças no conteúdo do elemento
var targetNode = document.getElementById('valorporta');
observer.observe(targetNode, { childList: true, subtree: true });

// Evento para acionar a função quando a página carregar
$(document).ready(function() {
    cifraopreco(); // Chama a função quando a página carregar
});
</script>

<script>
// Função para calcular a soma dos valores da coluna "Valor" da tabela e imprimir no console
function calcularTotalEImprimir() {
    let total = 0;
    // Seleciona todas as células com a classe "valor"
    document.querySelectorAll('.valor').forEach(function(td) {
        // Obtém o valor da célula e adiciona ao total
        total += parseFloat(td.textContent);
    });

    $('#valorfinalpedido').text(total.toFixed(2));

}

// Verifica se a tabela está carregada antes de iniciar o MutationObserver
document.addEventListener('DOMContentLoaded', function() {
    // Observa mudanças na tabela e chama a função calcularTotalEImprimir() sempre que houver uma alteração
    const observer = new MutationObserver(function() {
        calcularTotalEImprimir();
    });

    // Define as configurações de observação (observe mudanças no conteúdo da tabela)
    const config = { childList: true, subtree: true };
    // Inicia a observação na tabela
    observer.observe(document.getElementById('tabelaOrcamento'), config);
});
</script>

<script>
function cifraoprecototal() {
    var valortotal = $("#valorfinalpedido").text().trim();
    var cifraototal = $("#labeldototal");

    if (valortotal !== "") {
        cifraototal.removeClass("st2");
    } else {
        cifraototal.addClass("st2");
    }
}

var observer = new MutationObserver(function(mutations) {
    mutations.forEach(function(mutation) {
        cifraoprecototal();
    });
});

var targetNode = document.getElementById('valorfinalpedido');
observer.observe(targetNode, { childList: true, subtree: true });

$(document).ready(function() {
    cifraoprecototal();
});
</script>

<script>
$(document).ready(function() {
    // Adiciona o evento de clique para o botão de reset
    $('#btnReset').click(function() {
        inicializarElementos();
    });
});

</script>

<script>
// Função para selecionar a primeira opção disponível em um elemento select
function selecionarPrimeiraOpcaoDisponivel(selector) {
    var primeiroOpcao = $(selector + ' option:not(:disabled)').first();
    if (primeiroOpcao.length > 0) {
        $(selector).val(primeiroOpcao.val());
    }
}

// Função para desabilitar os elementos
function desabilitarElementos(selector) {
    $(selector).attr('disabled', 'disabled');
}

// Função para limpar os campos
function limparCampos(selector) {
    $(selector).val('');
}

// Função para limpar os label
function limparLabels(selector) {
    $(selector).text('');
}

// Função para inicializar os elementos
function inicializarElementos() {
    selecionarPrimeiraOpcaoDisponivel('#id_perfil');
    selecionarPrimeiraOpcaoDisponivel('#id_perfilpuxador');
    selecionarPrimeiraOpcaoDisponivel('#id_puxador');
    selecionarPrimeiraOpcaoDisponivel('#id_divisor');
    selecionarPrimeiraOpcaoDisponivel('#id_vidro');
    selecionarPrimeiraOpcaoDisponivel('#id_vidro1');
    selecionarPrimeiraOpcaoDisponivel('#id_vidro2');
    selecionarPrimeiraOpcaoDisponivel('#id_vidro3');

    desabilitarElementos('#id_perfilpuxador, #qtd-perfilpuxador, #posicao-perfilpuxador, #id_puxador, #qtd-puxador, #posicao-puxador, #tam-puxador, #id_divisor, #qtd-divisor, #id_vidro, #id_vidro1, #id_vidro2, #id_vidro3');

    // Limpar os campos desejados
    limparCampos('#qtd-perfilpuxador, #posicao-perfilpuxador, #qtd-puxador, #posicao-puxador, #tam-puxador, #qtd-divisor, #qtditens');

    // Limpar os labels
    limparLabels('#qtditens, #nomeporta, #valorporta');
}
</script>

<script>
// Função para excluir item
$(document).on('click', '.btn-excluir', function() {
    var id = $(this).data('id');

    // Remove a linha da tabela de orçamento
    $(this).closest('tr').remove();

    // Remove as linhas correspondentes na tabela de insumos
    $('#tabelaInsumos').find("tr[data-id-orcamento='" + id + "']").remove();
});
</script>

{% endblock %}

